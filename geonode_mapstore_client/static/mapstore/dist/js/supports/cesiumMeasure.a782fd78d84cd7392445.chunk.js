(self.webpackChunkgeonode_mapstore_client=self.webpackChunkgeonode_mapstore_client||[]).push([[68175],{372851:(e,r,t)=>{"use strict";t.r(r),t.d(r,{default:()=>oe});var n=t(124852),o=t.n(n),i=t(675263),a=t.n(i),c=t(968929),u=t.n(c),l=t(480681),s=t(200020),f=t(38560),d=t(376180),p=t(984110),m=t.n(p),v=t(509187),y=t.n(v),g=t(823493),h=t.n(g);function b(e,r){return function(e){if(Array.isArray(e))return e}(e)||function(e,r){var t=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=t){var n,o,i,a,c=[],u=!0,l=!1;try{if(i=(t=t.call(e)).next,0===r){if(Object(t)!==t)return;u=!1}else for(;!(u=(n=i.call(t)).done)&&(c.push(n.value),c.length!==r);u=!0);}catch(e){l=!0,o=e}finally{try{if(!u&&null!=t.return&&(a=t.return(),Object(a)!==a))return}finally{if(l)throw o}}return c}}(e,r)||O(e,r)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function C(e){return function(e){if(Array.isArray(e))return E(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||O(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function O(e,r){if(e){if("string"==typeof e)return E(e,r);var t=Object.prototype.toString.call(e).slice(8,-1);return"Object"===t&&e.constructor&&(t=e.constructor.name),"Map"===t||"Set"===t?Array.from(e):"Arguments"===t||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t)?E(e,r):void 0}}function E(e,r){(null==r||r>e.length)&&(r=e.length);for(var t=0,n=new Array(r);t<r;t++)n[t]=e[t];return n}function T(e,r){var t,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},o=n.getObjectsToExcludeOnPick,i=void 0===o?function(){return[]}:o,a=n.pickObjectsLimit,c=void 0===a?Number.MAX_VALUE:a,u=n.depthTestAgainstTerrain,l=i();void 0!==u&&(t=e.scene.globe.depthTestAgainstTerrain,e.scene.globe.depthTestAgainstTerrain=u),l.forEach((function(e){e&&(e.show=!1)})),e.scene.render();var s=function(e,r){var t=(arguments.length>2&&void 0!==arguments[2]?arguments[2]:{}).pickObjectsLimit,n=void 0===t?Number.MAX_VALUE:t,o=e.scene,i=e.camera,a=r.position||r.endPosition,c=o.pick(a),u=o.pickPosition(a);if(c&&u)return{cartesian:u,cartographic:d.Cartographic.fromCartesian(u),feature:c};var l,s=i.getPickRay(a),f=o.drillPickFromRay(s,n).find((function(e){var r=e.exclude,t=e.object,n=e.position;return!r&&n&&t}))||null;if(f)return{cartesian:f.position,cartographic:d.Cartographic.fromCartesian(f.position),feature:null==f||null===(l=f.object)||void 0===l?void 0:l.primitive};var p=o.globe.pick(s,o);return p?{cartesian:p,cartographic:d.Cartographic.fromCartesian(p)}:{}}(e,r,{pickObjectsLimit:c});return void 0!==u&&(e.scene.globe.depthTestAgainstTerrain=t),l.forEach((function(e){e&&(e.show=!0)})),s}function A(e,r){if((null==e?void 0:e.length)<3)return 0;for(var t=d.Cartesian2.packArray(e),n=y()(t,r,2),o=0,i=0;i<n.length;i+=3){var a=e[n[i]],c=e[n[i+1]],u=e[n[i+2]],l=d.Cartesian3.subtract(c,a,new d.Cartesian3),s=d.Cartesian3.subtract(u,a,new d.Cartesian3),f=d.Cartesian3.cross(l,s,new d.Cartesian3);o+=d.Cartesian3.magnitude(f)/2}return o}function w(e){return(null==e?void 0:e.length)<2?0:e.reduce((function(r,t,n){return e[n-1]?r+d.Cartesian3.distance(t,e[n-1]):r}),0)}function S(e){return Math.sign(d.Cartographic.fromCartesian(e[1]).height-d.Cartographic.fromCartesian(e[0]).height)}function I(e){var r=d.Cartographic.fromCartesian(e),t=r.longitude,n=r.latitude,o=r.height;return[d.Math.toDegrees(t),d.Math.toDegrees(n),o]}function P(e,r,t){var n=t.area,o=t.areaUom,i=t.length,a=t.lengthUom,c=t.height,u=t.heightUom,l=t.terrainCoordinates;switch(e){case"Point":return{type:"Feature",properties:l?{height:c,heightUom:u,terrainCoordinates:l}:{},geometry:{type:"Point",coordinates:I(r[r.length-1])}};case"LineString":return{type:"Feature",properties:{length:i,lengthUom:a},geometry:{type:"LineString",coordinates:r.map((function(e){return I(e)}))}};case"Polygon":return{type:"Feature",properties:{area:n,areaUom:o,length:i,lengthUom:a},geometry:{type:"Polygon",coordinates:[r.map((function(e){return I(e)}))]}};default:return null}}function D(e){var r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:18,t=arguments.length>2?arguments[2]:void 0;return new Promise((function(n){var o=t.map((function(e){return d.Cartographic.fromCartesian(e)})).map((function(e){return new d.Cartographic(e.longitude,e.latitude,0)})),i=null!=e&&e.availability?d.sampleTerrainMostDetailed(e,o):d.sampleTerrain(e,r,o);d.defined(i)?i.then((function(e){n(e)})).catch((function(){n()})):n()}))}const _=function(e){var r=e.map,t=e.active,o=e.geometryType,i=void 0===o?"LineString":o,a=e.onDrawStart,c=void 0===a?function(){}:a,u=e.onDrawing,l=void 0===u?function(){}:u,s=e.onMouseMove,f=void 0===s?function(){}:s,p=e.onDrawEnd,m=void 0===p?function(){}:p,v=e.onInit,y=void 0===v?function(){}:v,g=e.onDestroy,O=void 0===g?function(){}:g,E=e.getObjectsToExcludeOnPick,_=e.mouseMoveThrottleTime,N=void 0===_?100:_,L=e.depthTestAgainstTerrain,R=e.sampleTerrain,j=e.coordinatesLength,F=e.getPositionInfo,W=void 0===F?T:F,k=(0,n.useRef)(),M=(0,n.useRef)(!1),x=(0,n.useRef)(!1),G=(0,n.useRef)([]);function U(e,t){if(M.current){var n=W(r,e,{getObjectsToExcludeOnPick:E,depthTestAgainstTerrain:L}).cartesian;if(t&&G.current.splice(G.current.length-2,2),G.current.push(n),!function(e,r,t){if(t&&t!==r.length)return!1;switch(e){case"Point":case"LineString":default:return!0;case"Polygon":return r.length>2}}(i,C(G.current),j))return m({}),G.current=[],M.current=!1,null;var o="Polygon"===i?[].concat(C(G.current),[G.current[0]]):C(G.current),a=A(o),c=w(o);m({area:a,distance:c,coordinates:o,feature:P(i,o,{area:a,areaUom:"m²",length:c,lengthUom:"m"})}),G.current=[],M.current=!1}return null}return(0,n.useEffect)((function(){return null!=r&&r.canvas&&t&&(y(),k.current=new d.ScreenSpaceEventHandler(r.canvas),k.current.setInputAction((function(e){U(e,!0)}),d.ScreenSpaceEventType.LEFT_DOUBLE_CLICK),k.current.setInputAction((function(e){!function(e){if(M.current){if(G.current.length+1===j)return x.current=!0,U(e);var t=W(r,e,{getObjectsToExcludeOnPick:E,depthTestAgainstTerrain:L}).cartesian;if(t){var n=G.current[G.current.length-1];G.current.push(t);var o=C(G.current),i=A(o),a=w(o);l({area:i,distance:a,previousCartesian:n,cartesian:t,coordinates:C(G.current)})}}}(e),function(e){if(!M.current&&!x.current){var t=C(G.current);G.current=[];var n=W(r,e,{getObjectsToExcludeOnPick:E,depthTestAgainstTerrain:L}).cartesian;n&&(G.current.push(n),"Point"===i?((R&&2!==t.length?function(){var e,t;return D(null==r?void 0:r.terrainProvider,null!==(e=null==r||null===(t=r.terrainProvider)||void 0===t?void 0:t.sampleTerrainZoomLevel)&&void 0!==e?e:18,[n]).then((function(e){if(e){var r=b(e,1)[0];return[d.Cartographic.toCartesian(r),n]}return[n]}))}:function(){return Promise.resolve(2===t.length?t:[n])})().then((function(e){c({cartesian:e[e.length-1],coordinates:e}),m({coordinates:e,feature:R&&2===e.length?P(i,e,{height:S(e)*w(e),heightUom:"m",terrainCoordinates:I(e[0])}):P(i,e,{})})})),G.current=[]):(c({cartesian:n,coordinates:C(G.current)}),M.current=!0))}x.current&&(x.current=!1)}(e)}),d.ScreenSpaceEventType.LEFT_CLICK),k.current.setInputAction(h()((function(e){!function(e){if(t){var n=W(r,e,{getObjectsToExcludeOnPick:E,depthTestAgainstTerrain:L}).cartesian;if(n)if("Point"===i&&R){var o,a;D(null==r?void 0:r.terrainProvider,null!==(o=null==r||null===(a=r.terrainProvider)||void 0===a?void 0:a.sampleTerrainZoomLevel)&&void 0!==o?o:18,[n]).then((function(e){var r;if(e){var t=b(e,1)[0],o=[d.Cartographic.toCartesian(t),n];r=S(o)*w(o),G.current=o}else G.current=[n];f({distance:r,cartesian:n,coordinates:C(G.current)})}))}else{var c=G.current[G.current.length-1],u=[].concat(C(G.current),[n]),l=A(u),s=w(u);f({area:l,distance:s,previousCartesian:c,cartesian:n,coordinates:u})}}}(e)}),N),d.ScreenSpaceEventType.MOUSE_MOVE)),function(){O({coordinates:C(G.current)}),k.current&&(k.current.destroy(),k.current=null),G.current=[],M.current=!1}}),[r,t,i,N,R,j]),null};var N=t(808797),L=t(550172);function R(e,r){var t=d.Cartesian3.subtract(r,e,new d.Cartesian3),n=d.Cartesian3.multiplyByScalar(t,.5,new d.Cartesian3);return d.Cartesian3.add(e,n,new d.Cartesian3)}function j(e,r){var t=d.Cartesian3.normalize(e,new d.Cartesian3),n=d.Cartesian3.normalize(r,new d.Cartesian3),o=d.Cartesian3.dot(t,n);return d.Math.toDegrees(Math.acos(o))}function F(e){return e.map((function(r,t){var n=e[t-1],o=e[t+1];return n&&o?j(d.Cartesian3.subtract(n,r,new d.Cartesian3),d.Cartesian3.subtract(o,r,new d.Cartesian3)):null})).filter((function(e){return null!==e}))}function W(e){return new d.Cartesian3((e[0].x+e[1].x+e[2].x)/3,(e[0].y+e[1].y+e[2].y)/3,(e[0].z+e[1].z+e[2].z)/3)}function k(e,r){return e.map((function(t,n){var o=e[n-1],i=e[n+1];if(o&&i){var a=function(e,r){var t=d.Cartesian3.normalize(e,new d.Cartesian3),n=d.Cartesian3.normalize(r,new d.Cartesian3);return d.Cartesian3.cross(t,n,new d.Cartesian3)}(d.Cartesian3.subtract(o,t,new d.Cartesian3),d.Cartesian3.subtract(i,t,new d.Cartesian3)),c=-Math.sign(d.Cartesian3.dot(a,d.Cartesian3.subtract(t,r,new d.Cartesian3),new d.Cartesian3));return j(d.Cartesian3.multiplyByScalar(a,c,new d.Cartesian3),t)}return null})).filter((function(e){return null!==e}))}function M(e){return M="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},M(e)}function x(e,r){return function(e){if(Array.isArray(e))return e}(e)||function(e,r){var t=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=t){var n,o,i,a,c=[],u=!0,l=!1;try{if(i=(t=t.call(e)).next,0===r){if(Object(t)!==t)return;u=!1}else for(;!(u=(n=i.call(t)).done)&&(c.push(n.value),c.length!==r);u=!0);}catch(e){l=!0,o=e}finally{try{if(!u&&null!=t.return&&(a=t.return(),Object(a)!==a))return}finally{if(l)throw o}}return c}}(e,r)||$(e,r)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function G(e,r,t){return G=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}()?Reflect.construct.bind():function(e,r,t){var n=[null];n.push.apply(n,r);var o=new(Function.bind.apply(e,n));return t&&U(o,t.prototype),o},G.apply(null,arguments)}function U(e,r){return U=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,r){return e.__proto__=r,e},U(e,r)}function H(e,r){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);r&&(n=n.filter((function(r){return Object.getOwnPropertyDescriptor(e,r).enumerable}))),t.push.apply(t,n)}return t}function B(e){for(var r=1;r<arguments.length;r++){var t=null!=arguments[r]?arguments[r]:{};r%2?H(Object(t),!0).forEach((function(r){z(e,r,t[r])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):H(Object(t)).forEach((function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(t,r))}))}return e}function z(e,r,t){return(r=function(e){var r=function(e,r){if("object"!==M(e)||null===e)return e;var t=e[Symbol.toPrimitive];if(void 0!==t){var n=t.call(e,"string");if("object"!==M(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"===M(r)?r:String(r)}(r))in e?Object.defineProperty(e,r,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[r]=t,e}function Y(e){return function(e){if(Array.isArray(e))return V(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||$(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function $(e,r){if(e){if("string"==typeof e)return V(e,r);var t=Object.prototype.toString.call(e).slice(8,-1);return"Object"===t&&e.constructor&&(t=e.constructor.name),"Map"===t||"Set"===t?Array.from(e):"Arguments"===t||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t)?V(e,r):void 0}}function V(e,r){(null==r||r>e.length)&&(r=e.length);for(var t=0,n=new Array(r);t<r;t++)n[t]=e[t];return n}function K(e){var r=d.Cartesian3.distance(e[1],e[0]),t=d.Cartesian3.distance(e[1],e[2]),n=d.Cartesian3.normalize(d.Cartesian3.subtract(e[0],e[1],new d.Cartesian3),new d.Cartesian3),o=d.Cartesian3.normalize(d.Cartesian3.subtract(e[2],e[1],new d.Cartesian3),new d.Cartesian3),i=d.Cartesian3.normalize(R(n,o),new d.Cartesian3),a=(r>t?t:r)/3;return[n,i,o].map((function(r){return d.Cartesian3.add(e[1],d.Cartesian3.multiplyByScalar(r,a,new d.Cartesian3),new d.Cartesian3)}))}const q=function(e){var r,t,i=e.map,a=e.active,c=void 0!==a&&a,u=e.type,l=e.clearId,s=e.hideInfoLabel,f=e.hideSegmentsLengthLabels,p=e.onUpdateCollection,v=void 0===p?function(){}:p,y=e.unitsOfMeasure,g=void 0===y?{}:y,h=e.tooltipLabels,b=void 0===h?{}:h,C=e.style,O=void 0===C?{primaryLabel:{font:"12px sans-serif",fillColor:"#ffffff",backgroundColor:"rgba(0, 0, 0, 0.6)"},secondaryLabel:{font:"12px sans-serif",fillColor:"#ffffff",outlineColor:"#000000",outlineWidth:4,offset:[0,-16]},tooltip:{font:"12px sans-serif",fillColor:"#ffffff",backgroundColor:"rgba(0, 0, 0, 0.5)",offset:[8,8]},lineDrawing:{color:"#000000",opacity:1,depthFailColor:"#000000",depthFailOpacity:.4,width:3,dashLength:8},line:{color:"#ffcc33",opacity:1,depthFailColor:"#ffcc33",depthFailOpacity:.4,width:2},areaDrawing:{color:"#ffffff",opacity:.5,depthFailColor:"#ffffff",depthFailOpacity:.25},area:{color:"#ffffff",opacity:.5,depthFailColor:"#ffffff",depthFailOpacity:.25},cursor:{color:"#000000"},coordinatesNode:{color:"#333333"}}:C,E=e.infoLabelsFormat,T=void 0===E?(z(r={},N.sW.POLYLINE_DISTANCE_3D,(function(e){return e})),z(r,N.sW.AREA_3D,(function(e){return e})),z(r,N.sW.HEIGHT_FROM_TERRAIN,(function(e){return e})),z(r,N.sW.ANGLE_3D,(function(e){return e})),z(r,N.sW.SLOPE,(function(e){return e})),z(r,N.sW.POINT_COORDINATES,(function(e){var r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},t=r.latitude,n=r.longitude;return"latitude: ".concat(t.toFixed(6),"\n")+"longitude: ".concat(n.toFixed(6),"\n")+"altitude: ".concat(e)})),r):E,A=e.getPositionInfo,w=(0,n.useRef)(),S=(0,n.useRef)(),I=(0,n.useRef)(),P=(0,n.useRef)(),D=(0,n.useRef)(),j=(0,n.useRef)(),M=(0,n.useRef)({type:"FeatureCollection",features:[]}),U=(0,n.useRef)(),H=(0,n.useRef)(),$=(0,n.useRef)();$.current=g;var V=(0,n.useRef)();V.current=b;var q=(0,n.useRef)();function X(){return{color:(0,L.KF)(B({},null==O?void 0:O.coordinatesNode)),disableDepthTestDistance:Number.POSITIVE_INFINITY}}function Z(){var e=(null==O?void 0:O.primaryLabel)||{},r=e.font,t=void 0===r?"12px sans-serif":r,n=e.fillColor,o=void 0===n?"#ffffff":n,i=e.backgroundColor,a=void 0===i?"rgba(0, 0, 0, 0.6)":i,c=e.offset,u=void 0===c?[0,-16]:c;return{font:t,disableDepthTestDistance:Number.POSITIVE_INFINITY,fillColor:(0,L.KF)({color:o}),showBackground:!0,backgroundColor:(0,L.KF)({color:a}),backgroundPadding:new d.Cartesian2(4,4),pixelOffset:G(d.Cartesian2,Y(u)),horizontalOrigin:d.HorizontalOrigin.CENTER,verticalOrigin:d.VerticalOrigin.BASELINE}}function J(e,r,t){return e&&e.value!==t?"".concat((0,N.Ov)(r,t,e.value).toFixed(2)," ").concat(e.label):"".concat(r.toFixed(2)," ").concat(e.label)}function Q(e,r,t){var n,o=t===N.sW.AREA_3D?N.vq[null===(n=$.current[t])||void 0===n?void 0:n.value]:$.current[t];return f?null:r.map((function(t,n){var i,a,c,u,l,s,f,p,m,v=r[n+1];if(v){var y=R(t,v),g=d.Cartesian3.distance(t,v),h=J(o,g,"m");e.add(B({position:y,text:h},(c=void 0===(a=(i=(null==O?void 0:O.secondaryLabel)||{}).font)?"12px sans-serif":a,l=void 0===(u=i.fillColor)?"#ffffff":u,f=void 0===(s=i.outlineColor)?"#000000":s,m=void 0===(p=i.outlineWidth)?4:p,{font:c,disableDepthTestDistance:Number.POSITIVE_INFINITY,fillColor:(0,L.KF)({color:l}),outlineColor:(0,L.KF)({color:f}),outlineWidth:m,style:d.LabelStyle.FILL_AND_OUTLINE,showBackground:!1,backgroundPadding:new d.Cartesian2(4,4),pixelOffset:new d.Cartesian2(0,0),horizontalOrigin:d.HorizontalOrigin.CENTER,verticalOrigin:d.VerticalOrigin.BASELINE})));var b=d.Cartographic.fromCartesian(y),C=b.longitude,E=b.latitude,T=b.height;return[d.Math.toDegrees(C),d.Math.toDegrees(E),T,g,h]}return null})).filter((function(e){return e}))}function ee(e){var r,t,n,o,a=e.coordinates,c=e.feature,u=e.measureType,l="",f=a[a.length-1],d=$.current[u],p=q.current[u];switch(u){case N.sW.HEIGHT_FROM_TERRAIN:I.current.add({position:a[a.length-1],image:U.current,color:(0,L.KF)({color:"#ffff00"}),disableDepthTestDistance:Number.POSITIVE_INFINITY,allowPicking:!1}),l=p(J(d,c.properties.height,"m")),w.current.add((0,L.c4)(B(B({},null==O?void 0:O.line),{},{coordinates:Y(a)})));break;case N.sW.ANGLE_3D:w.current.add((0,L.c4)(B(B({},null==O?void 0:O.line),{},{coordinates:Y(a)}))),l=p(J(d,n=x(F(a),1)[0],"deg")),f=a[1],w.current.add((0,L.c4)(B(B({},null==O?void 0:O.line),{},{coordinates:K(a)})));break;case N.sW.SLOPE:w.current.add((0,L.XI)(B(B({},null==O?void 0:O.area),{},{coordinates:Y(a)}))),w.current.add((0,L.c4)(B(B({},null==O?void 0:O.line),{},{coordinates:Y(a)}))),l=p(J(d,o=x(k(a,null==i||null===(r=i.camera)||void 0===r?void 0:r.position),1)[0],"deg")),f=W(a);break;case N.sW.POINT_COORDINATES:I.current.add({position:a[a.length-1],image:U.current,color:(0,L.KF)({color:"#ffff00"}),disableDepthTestDistance:Number.POSITIVE_INFINITY,allowPicking:!1}),l=p(J(d,c.geometry.coordinates[2],"m"),{latitude:c.geometry.coordinates[1],longitude:c.geometry.coordinates[0]});break;case N.sW.POLYLINE_DISTANCE_3D:a.length>1&&(w.current.add((0,L.c4)(B(B({},null==O?void 0:O.line),{},{coordinates:Y(a)}))),t=Q(D.current,a,N.sW.POLYLINE_DISTANCE_3D),l=p(J(d,c.properties.length,"m")));break;case N.sW.AREA_3D:a.length>2&&(w.current.add((0,L.XI)(B(B({},null==O?void 0:O.area),{},{coordinates:Y(a)}))),w.current.add((0,L.c4)(B(B({},null==O?void 0:O.line),{},{coordinates:Y(a)}))),t=Q(D.current,a,N.sW.AREA_3D),l=p(J(d,c.properties.area,"m²")))}s||D.current.add(B({position:f,text:l},Z()));var v=null!=c&&c.id?c.id:m()();return B(B({},c),{},{id:v,properties:B(B(B(B(B({},null==c?void 0:c.properties),{},{id:v,measureType:u},t&&{segments:t,segmentsCRS:"WGS84",segmentsColumns:["longitude","latitude","height:m","length:m","label"]}),l&&{infoLabelText:l}),n&&{angle:n,angleUom:"deg"}),o&&{slope:o,slopeUom:"deg"})})}function re(e){!function(e){var r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},t=r.area,n=r.distance;S.current.removeAll(),P.current.removeAll(),j.current.removeAll();var o,a,c,l,f,p,m,v,y,g="",h="",b=e[e.length-1],C=$.current[u],E=V.current[u]||{},T=q.current[u];switch(u){case N.sW.HEIGHT_FROM_TERRAIN:h=E.start,2===(null==e?void 0:e.length)&&(S.current.add((0,L.c4)(B(B({},null==O?void 0:O.lineDrawing),{},{coordinates:Y(e)}))),g=n?T(J(C,n,"m")):"");break;case N.sW.ANGLE_3D:h=E.start,e.length>1&&S.current.add((0,L.c4)(B(B({},null==O?void 0:O.lineDrawing),{},{coordinates:Y(e)}))),3===e.length&&(g=T(J(C,x(F(e),1)[0],"deg")),b=e[1],S.current.add((0,L.c4)(B(B({},null==O?void 0:O.lineDrawing),{},{coordinates:K(e)}))));break;case N.sW.SLOPE:var A;h=E.start,e.length>1&&S.current.add((0,L.c4)(B(B({},null==O?void 0:O.lineDrawing),{},{coordinates:Y(e)}))),3===e.length&&(S.current.add((0,L.XI)(B(B({},null==O?void 0:O.areaDrawing),{},{coordinates:Y(e)}))),g=T(J(C,x(k(e,null==i||null===(A=i.camera)||void 0===A?void 0:A.position),1)[0],"deg")),b=W(e));break;case N.sW.POINT_COORDINATES:if(h=E.start,e[0]){var w=d.Cartographic.fromCartesian(e[0]);g=T(J(C,w.height,"m"),{latitude:w.latitude,longitude:w.longitude})}break;case N.sW.POLYLINE_DISTANCE_3D:h=E.start,e.length>1&&(h=E.end,g=T(J(C,n,"m")),S.current.add((0,L.c4)(B(B({},null==O?void 0:O.lineDrawing),{},{coordinates:Y(e)}))),Q(j.current,e,N.sW.POLYLINE_DISTANCE_3D),e.forEach((function(r,t){t!==e.length-1&&P.current.add(B({position:r,image:H.current},X()))})));break;case N.sW.AREA_3D:h=E.start,e.length>1&&(S.current.add((0,L.XI)(B(B({},null==O?void 0:O.areaDrawing),{},{coordinates:Y(e)}))),S.current.add((0,L.c4)(B(B({},null==O?void 0:O.lineDrawing),{},{coordinates:Y(e)}))),Q(j.current,e,N.sW.AREA_3D),e.forEach((function(r,t){t!==e.length-1&&P.current.add(B({position:r,image:H.current},X()))}))),e.length>2&&(h=E.end,g=T(J(C,t,"m²"))),2===e.length&&(h=E.missingVertex)}e.length>0&&(P.current.add({position:e[e.length-1],image:U.current,color:(0,L.KF)(B({},null==O?void 0:O.cursor)),disableDepthTestDistance:Number.POSITIVE_INFINITY}),j.current.add(B({position:e[e.length-1],text:h},(c=void 0===(a=(o=(null==O?void 0:O.tooltip)||{}).font)?"12px sans-serif":a,f=void 0===(l=o.fillColor)?"#ffffff":l,m=void 0===(p=o.backgroundColor)?"rgba(0, 0, 0, 0.5)":p,y=void 0===(v=o.offset)?[8,8]:v,{font:c,disableDepthTestDistance:Number.POSITIVE_INFINITY,fillColor:(0,L.KF)({color:f}),showBackground:!0,backgroundColor:(0,L.KF)({color:m}),backgroundPadding:new d.Cartesian2(4,4),pixelOffset:G(d.Cartesian2,Y(y)),horizontalOrigin:d.HorizontalOrigin.LEFT,verticalOrigin:d.VerticalOrigin.TOP}))),s||j.current.add(B({position:b,text:g},Z()))),i.scene.requestRender()}(e.coordinates,{area:e.area,distance:e.distance})}return q.current=T,(0,n.useEffect)((function(){return i&&(w.current=new d.PrimitiveCollection({destroyPrimitives:!0}),i.scene.primitives.add(w.current),I.current=new d.BillboardCollection,i.scene.primitives.add(I.current),D.current=new d.LabelCollection,i.scene.primitives.add(D.current),S.current=new d.PrimitiveCollection({destroyPrimitives:!0}),i.scene.primitives.add(S.current),P.current=new d.BillboardCollection,i.scene.primitives.add(P.current),j.current=new d.LabelCollection,i.scene.primitives.add(j.current),U.current=(0,L.xB)(12,{stroke:"#ffffff",strokeWidth:2,fill:!1}),H.current=(0,L.xB)(8,{stroke:"#ffffff",strokeWidth:2,fill:!1})),function(){null!=i&&i.isDestroyed&&!i.isDestroyed()&&((0,L.U2)(i,w.current),w.current=null,(0,L.U2)(i,I.current),I.current=null,(0,L.U2)(i,D.current),D.current=null,(0,L.U2)(i,S.current),S.current=null,(0,L.U2)(i,P.current),P.current=null,(0,L.U2)(i,j.current),j.current=null)}}),[i]),(0,n.useEffect)((function(){c||(S.current.removeAll(),P.current.removeAll(),j.current.removeAll(),i.scene.requestRender())}),[c]),(0,n.useEffect)((function(){l&&(S.current.removeAll(),P.current.removeAll(),j.current.removeAll(),w.current.removeAll(),I.current.removeAll(),D.current.removeAll(),M.current={type:"FeatureCollection",features:[]},v(M.current),i.scene.requestRender())}),[l]),(0,n.useEffect)((function(){var e;null!==(e=g[u])&&void 0!==e&&e.value&&function(){w.current.removeAll(),I.current.removeAll(),D.current.removeAll();var e=(M.current||{}).features,r=(void 0===e?[]:e).map((function(e){var r,t=function(e){var r,t,n,o=e.properties,i=void 0===o?{}:o,a=e.geometry,c=void 0===a?{}:a,u=i.measureType,l=c.coordinates,s=void 0===l?[]:l;switch(u){case N.sW.HEIGHT_FROM_TERRAIN:return[d.Cartographic.toCartesian((r=d.Cartographic).fromDegrees.apply(r,Y(null==i?void 0:i.terrainCoordinates))),d.Cartographic.toCartesian((t=d.Cartographic).fromDegrees.apply(t,Y(s)))];case N.sW.POINT_COORDINATES:return[d.Cartographic.toCartesian((n=d.Cartographic).fromDegrees.apply(n,Y(s)))];case N.sW.ANGLE_3D:case N.sW.POLYLINE_DISTANCE_3D:return s.map((function(e){var r;return d.Cartographic.toCartesian((r=d.Cartographic).fromDegrees.apply(r,Y(e)))}));case N.sW.SLOPE:case N.sW.AREA_3D:return s[0].map((function(e){var r;return d.Cartographic.toCartesian((r=d.Cartographic).fromDegrees.apply(r,Y(e)))}));default:return[]}}(e);return ee({coordinates:t,feature:e,measureType:null==e||null===(r=e.properties)||void 0===r?void 0:r.measureType})}));M.current.features=r,v(M.current),i.scene.requestRender()}()}),[null===(t=g[u])||void 0===t?void 0:t.value]),o().createElement(_,{key:u,map:i,active:c,geometryType:function(){switch(u){case N.sW.HEIGHT_FROM_TERRAIN:case N.sW.POINT_COORDINATES:return"Point";case N.sW.ANGLE_3D:case N.sW.POLYLINE_DISTANCE_3D:return"LineString";case N.sW.SLOPE:case N.sW.AREA_3D:return"Polygon";default:return null}}(),onDrawStart:re,onMouseMove:re,onDrawing:re,onDrawEnd:function(e){var r=e.coordinates,t=e.feature;r&&t&&function(e,r){var t=ee({coordinates:e,feature:r.feature,measureType:u});M.current.features.push(t),v(M.current),i.scene.requestRender()}(r,{feature:t})},depthTestAgainstTerrain:!1,sampleTerrain:N.sW.HEIGHT_FROM_TERRAIN===u,coordinatesLength:function(){switch(u){case N.sW.ANGLE_3D:case N.sW.SLOPE:return 3;case N.sW.HEIGHT_FROM_TERRAIN:case N.sW.POINT_COORDINATES:case N.sW.POLYLINE_DISTANCE_3D:case N.sW.AREA_3D:default:return null}}(),getPositionInfo:A,getObjectsToExcludeOnPick:function(){return[S.current,P.current,j.current,w.current,I.current,D.current]}})};var X=t(904577),Z=t(815135),J=t(86638);function Q(e){return Q="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Q(e)}function ee(e,r,t){return(r=function(e){var r=function(e,r){if("object"!==Q(e)||null===e)return e;var t=e[Symbol.toPrimitive];if(void 0!==t){var n=t.call(e,"string");if("object"!==Q(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"===Q(r)?r:String(r)}(r))in e?Object.defineProperty(e,r,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[r]=t,e}function re(e,r){(null==r||r>e.length)&&(r=e.length);for(var t=0,n=new Array(r);t<r;t++)n[t]=e[t];return n}var te=(0,Z.Z)(f.Z);function ne(e,r){var t,i,a,c,f=e.map,d=e.active,p=e.measureType,m=e.onChangeMeasureType,v=e.defaultMeasureType,y=e.hideInfoLabel,g=e.hideSegmentsLengthLabels,h=e.unitsOfMeasure,b=e.unitsOfMeasureOptions,C=void 0===b?N.O$:b,O=e.onUpdateFeatures,E=e.onChangeUnitOfMeasure,T=e.tools,A=void 0===T?[N.sW.POLYLINE_DISTANCE_3D,N.sW.AREA_3D,N.sW.POINT_COORDINATES,N.sW.HEIGHT_FROM_TERRAIN,N.sW.ANGLE_3D,N.sW.SLOPE]:T,w=e.onClose,S=r.messages,I=(a=(0,n.useState)(0),c=2,function(e){if(Array.isArray(e))return e}(a)||function(e,r){var t=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=t){var n,o,i,a,c=[],u=!0,l=!1;try{if(i=(t=t.call(e)).next,0===r){if(Object(t)!==t)return;u=!1}else for(;!(u=(n=i.call(t)).done)&&(c.push(n.value),c.length!==r);u=!0);}catch(e){l=!0,o=e}finally{try{if(!u&&null!=t.return&&(a=t.return(),Object(a)!==a))return}finally{if(l)throw o}}return c}}(a,c)||function(e,r){if(e){if("string"==typeof e)return re(e,r);var t=Object.prototype.toString.call(e).slice(8,-1);return"Object"===t&&e.constructor&&(t=e.constructor.name),"Map"===t||"Set"===t?Array.from(e):"Arguments"===t||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t)?re(e,r):void 0}}(a,c)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()),P=I[0],D=I[1],_=C[p];function L(e){m(e)}return(0,n.useEffect)((function(){d&&L(v)}),[d,v]),d?o().createElement(o().Fragment,null,o().createElement(q,{map:f,active:!!p,type:p,clearId:P,hideInfoLabel:y,hideSegmentsLengthLabels:g,unitsOfMeasure:h,onUpdateCollection:function(e){return O((null==e?void 0:e.features)||[])},tooltipLabels:(t={},ee(t,N.sW.POLYLINE_DISTANCE_3D,{start:(0,J.S$)(S,"measureComponent.tooltipPolylineDistance3DStart"),end:(0,J.S$)(S,"measureComponent.tooltipPolylineDistance3DEnd")}),ee(t,N.sW.AREA_3D,{start:(0,J.S$)(S,"measureComponent.tooltipArea3DStart"),missingVertex:(0,J.S$)(S,"measureComponent.tooltipArea3DMissingVertex"),end:(0,J.S$)(S,"measureComponent.tooltipArea3DEnd")}),ee(t,N.sW.POINT_COORDINATES,{start:(0,J.S$)(S,"measureComponent.tooltipPointCoordinatesStart")}),ee(t,N.sW.HEIGHT_FROM_TERRAIN,{start:(0,J.S$)(S,"measureComponent.tooltipHeightFromTerrainStart")}),ee(t,N.sW.ANGLE_3D,{start:(0,J.S$)(S,"measureComponent.tooltipAngle3DStart")}),ee(t,N.sW.SLOPE,{start:(0,J.S$)(S,"measureComponent.tooltipSlopeStart")}),t),infoLabelsFormat:(i={},ee(i,N.sW.POLYLINE_DISTANCE_3D,(function(e){return e})),ee(i,N.sW.AREA_3D,(function(e){return e})),ee(i,N.sW.POINT_COORDINATES,(function(e){var r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},t=r.latitude,n=r.longitude;return"".concat((0,J.S$)(S,"measureComponent.latitude"),": ").concat(t.toFixed(6),"\n")+"".concat((0,J.S$)(S,"measureComponent.longitude"),": ").concat(n.toFixed(6),"\n")+"".concat((0,J.S$)(S,"measureComponent.altitude"),": ").concat(e)})),ee(i,N.sW.HEIGHT_FROM_TERRAIN,(function(e){return e})),ee(i,N.sW.ANGLE_3D,(function(e){return e})),ee(i,N.sW.SLOPE,(function(e){return e})),i)}),o().createElement(X.Z,{info:o().createElement(s.DropdownList,{disabled:!_,value:h[p],data:_,onChange:function(e){E(p,e)},textField:"label",valueField:"value"}),onClose:w},o().createElement(l.ButtonToolbar,null,o().createElement(l.ButtonGroup,null,A.map((function(e){return o().createElement(te,{key:e,className:"square-button-md",bsStyle:p===e?"success":"primary",tooltipId:"measureComponent.".concat(u()(e),"Measure"),active:p===e,onClick:L.bind(null,e)},o().createElement(l.Glyphicon,{glyph:N.r2[e]}))}))),o().createElement(l.ButtonGroup,null,o().createElement(te,{className:"square-button-md",bsStyle:"primary",tooltipId:"measureComponent.resetTooltip",onClick:function(){return D(P+1)}},o().createElement(l.Glyphicon,{glyph:"trash"})))))):null}ne.contextTypes={messages:a().object};const oe=ne},550172:(e,r,t)=>{"use strict";t.d(r,{KF:()=>y,c4:()=>g,XI:()=>h,U2:()=>b,xB:()=>C,ir:()=>O});var n=t(376180),o=t(65792),i=t.n(o),a=t(545578),c=t.n(a);function u(e){return u="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},u(e)}function l(e){return function(e){if(Array.isArray(e))return v(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||m(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function s(e,r){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);r&&(n=n.filter((function(r){return Object.getOwnPropertyDescriptor(e,r).enumerable}))),t.push.apply(t,n)}return t}function f(e){for(var r=1;r<arguments.length;r++){var t=null!=arguments[r]?arguments[r]:{};r%2?s(Object(t),!0).forEach((function(r){d(e,r,t[r])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):s(Object(t)).forEach((function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(t,r))}))}return e}function d(e,r,t){return(r=function(e){var r=function(e,r){if("object"!==u(e)||null===e)return e;var t=e[Symbol.toPrimitive];if(void 0!==t){var n=t.call(e,"string");if("object"!==u(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"===u(r)?r:String(r)}(r))in e?Object.defineProperty(e,r,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[r]=t,e}function p(e,r){return function(e){if(Array.isArray(e))return e}(e)||function(e,r){var t=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=t){var n,o,i,a,c=[],u=!0,l=!1;try{if(i=(t=t.call(e)).next,0===r){if(Object(t)!==t)return;u=!1}else for(;!(u=(n=i.call(t)).done)&&(c.push(n.value),c.length!==r);u=!0);}catch(e){l=!0,o=e}finally{try{if(!u&&null!=t.return&&(a=t.return(),Object(a)!==a))return}finally{if(l)throw o}}return c}}(e,r)||m(e,r)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function m(e,r){if(e){if("string"==typeof e)return v(e,r);var t=Object.prototype.toString.call(e).slice(8,-1);return"Object"===t&&e.constructor&&(t=e.constructor.name),"Map"===t||"Set"===t?Array.from(e):"Arguments"===t||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t)?v(e,r):void 0}}function v(e,r){(null==r||r>e.length)&&(r=e.length);for(var t=0,n=new Array(r);t<r;t++)n[t]=e[t];return n}var y=function(e){var r=e.color,t=e.opacity,o=p(i()(r).gl(),4),a=o[0],c=o[1],u=o[2],l=o[3];return void 0!==t?new n.Color(a,c,u,t):new n.Color(a,c,u,l)},g=function(e){var r=e.coordinates,t=e.width,o=void 0===t?4:t,i=e.color,a=void 0===i?"#ff00ff":i,c=e.opacity,u=void 0===c?1:c,s=e.depthFailColor,d=e.depthFailOpacity,p=e.dashLength,m=e.clampToGround;return new n[m?"GroundPolylinePrimitive":"Primitive"](f(f({geometryInstances:new n.GeometryInstance({geometry:m?new n.GroundPolylineGeometry({positions:l(r),width:o}):new n.PolylineGeometry({positions:l(r),width:o,arcType:n.ArcType.NONE})}),appearance:new n.PolylineMaterialAppearance({material:p?n.Material.fromType("PolylineDash",{color:y({color:a,opacity:u}),dashLength:p}):n.Material.fromType("Color",{color:y({color:a,opacity:u})})})},s&&{depthFailAppearance:new n.PolylineMaterialAppearance({material:p?n.Material.fromType("PolylineDash",{color:y({color:s,opacity:d}),dashLength:p}):n.Material.fromType("Color",{color:y({color:s,opacity:d})})})}),{},{allowPicking:!1,asynchronous:!1}))},h=function(e){var r=e.coordinates,t=e.color,o=void 0===t?"#ff00ffAA":t,i=e.opacity,a=void 0===i?1:i,c=e.depthFailColor,u=e.depthFailOpacity;return new n.Primitive(f(f({geometryInstances:new n.GeometryInstance({geometry:new n.PolygonGeometry({polygonHierarchy:new n.PolygonHierarchy(l(r)),perPositionHeight:!0})}),appearance:new n.MaterialAppearance({material:n.Material.fromType("Color",{color:y({color:o,opacity:a})}),faceForward:!0})},c&&{depthFailAppearance:new n.MaterialAppearance({material:n.Material.fromType("Color",{color:y({color:c,opacity:u})}),faceForward:!0})}),{},{allowPicking:!1,asynchronous:!1}))},b=function(e,r){var t;null!=e&&null!==(t=e.scene)&&void 0!==t&&t.primitives&&r&&!r.isDestroyed()&&(r.removeAll(),e.scene.primitives.remove(r))},C=function(e){var r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},t=r.stroke,n=r.strokeWidth,o=void 0===n?1:n,i=r.fill,a=void 0===i?"#ffffff":i,c=t?e+2*o:e,u=document.createElement("canvas");u.setAttribute("width",c),u.setAttribute("height",c);var l=u.getContext("2d");return l.beginPath(),a&&(l.fillStyle="#ffffff"),t&&(l.strokeStyle=t,l.lineWidth=o),l.arc(c/2,c/2,e/2,0,2*Math.PI),a&&l.fill(),t&&l.stroke(),u},O=function(e,r,o){return t.e(79706).then(t.bind(t,979706)).then((function(i){var a,u,s=i.default,f=(o?e:s(e)).geometry;return(u=l((null==f||null===(a=f.coordinates)||void 0===a?void 0:a[0])||[]),Promise.all([t.e(86355),t.e(29014)]).then(t.bind(t,529014)).then((function(e){return(0,e.default)({type:"Feature",geometry:{type:"LineString",coordinates:u},properties:{}})?u:l(u).reverse()}))).then((function(e){for(var t=c()(r?e:e.reverse(),(function(e){return"".concat(e[0]).concat(e[1])})).map((function(e){var r=p(e,3),t=r[0],o=r[1],i=r[2],a=void 0===i?0:i;return n.Cartesian3.fromDegrees(t,o,a)})),o=t.length,i=[],a=0;a<o;++a){var u=(a+1)%o,l=n.Cartesian3.add(t[a],t[u],new n.Cartesian3);l=n.Cartesian3.multiplyByScalar(l,.5,l);var s=n.Cartesian3.normalize(l,new n.Cartesian3),f=n.Cartesian3.subtract(t[u],l,new n.Cartesian3);f=n.Cartesian3.normalize(f,f);var d=n.Cartesian3.cross(f,s,new n.Cartesian3);d=n.Cartesian3.normalize(d,d);var m=new n.Plane(d,0),v=n.Plane.getPointDistance(m,l);i.push(new n.ClippingPlane(d,v))}return i}))}))}}}]);