(self.webpackChunkgeonode_mapstore_client=self.webpackChunkgeonode_mapstore_client||[]).push([[79216],{2400:(e,t,r)=>{"use strict";r.d(t,{Z:()=>j});var o=r(124852),n=r.n(o),i=r(119690),a=r(737295),s=r.n(a),p=r(675263),l=r.n(p),u=r(59854),c=r.n(u),d=r(414293),m=r.n(d),f=r(552259);function h(e){return h="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},h(e)}function y(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,o)}return r}function v(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?y(Object(r),!0).forEach((function(t){S(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):y(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function g(e){return function(e){if(Array.isArray(e))return b(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||function(e,t){if(e){if("string"==typeof e)return b(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?b(e,t):void 0}}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function b(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,o=new Array(t);r<t;r++)o[r]=e[r];return o}function O(e,t){for(var r=0;r<t.length;r++){var o=t[r];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,T(o.key),o)}}function P(e,t){return P=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},P(e,t)}function w(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function E(e){return E=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},E(e)}function S(e,t,r){return(t=T(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function T(e){var t=function(e,t){if("object"!==h(e)||null===e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var o=r.call(e,"string");if("object"!==h(o))return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"===h(t)?t:String(t)}var C=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&P(e,t)}(l,e);var t,r,o,a,p=(o=l,a=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,t=E(o);if(a){var r=E(this).constructor;e=Reflect.construct(t,arguments,r)}else e=t.apply(this,arguments);return function(e,t){if(t&&("object"===h(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return w(e)}(this,e)});function l(){var e;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,l);for(var t=arguments.length,r=new Array(t),o=0;o<t;o++)r[o]=arguments[o];return S(w(e=p.call.apply(p,[this].concat(r))),"updateZIndex",(function(t){var r=t||e.props.position;if(e.provider){var o=e.props.map.imageryLayers._layers.indexOf(e.provider),n=g(e.props.map.imageryLayers._layers).sort((function(t,o){return(t===e.provider?r:t._position)-(o===e.provider?r:o._position)})).indexOf(e.provider)-o;0!==n&&g(new Array(Math.abs(n)).keys()).forEach((function(){e.props.map.imageryLayers[n>0?"raise":"lower"](e.provider)})),e.props.map.scene.requestRender()}})),S(w(e),"setLayerVisibility",(function(t){var r,o,n=e.getVisibilityOption(e.props),i=e.getVisibilityOption(t);i!==n&&(null!==(r=e.layer)&&void 0!==r&&r.detached&&null!==(o=e.layer)&&void 0!==o&&o.setVisible?e.layer.setVisible(i):i?(e.addLayer(t),e.updateZIndex()):e.removeLayer(),t.map.scene.requestRender())})),S(w(e),"getVisibilityOption",(function(e){var t=e.options,r=void 0===t?{}:t,o=e.zoom,n=e.resolutions,i=void 0===n?(0,f.getResolutions)():n,a=c()(o),s=r||{},p=s.visibility,l=s.minResolution,u=void 0===l?-1/0:l,d=s.maxResolution,h=void 0===d?1/0:d;if(!s.disableResolutionLimits&&!m()(i[a])){var y=i[a];if(!(y<h&&y>=u))return!1}return!1!==p})),S(w(e),"setLayerOpacity",(function(t){t!==(e.props.options&&void 0!==e.props.options.opacity?e.props.options.opacity:1)&&e.layer&&e.provider&&(e.provider.alpha=t,e.props.map.scene.requestRender())})),S(w(e),"createLayer",(function(t,r,o,n,a){if(t){var p=s()({},r,o?{zIndex:o}:null,{securityToken:a});e.layer=i.default.createLayer(t,p,n),e.layer&&(e.layer.layerName=r.name,e.layer.layerId=r.id),null===e.layer&&e.props.onCreationError(r),e.props.map.scene.requestRender()}})),S(w(e),"updateLayer",(function(t,r){var o=i.default.updateLayer(t.type,e.layer,v(v({},t.options),{},{securityToken:t.securityToken}),v(v({},r.options),{},{securityToken:r.securityToken}),e.props.map);o&&(e.removeLayer(),e.layer=o,t.options.visibility&&e.addLayer(t)),t.map.scene.requestRender()})),S(w(e),"addLayerInternal",(function(t){t.options.useForElevation?e.props.map.terrainProvider=e.layer:(e.provider=e.props.map.imageryLayers.addImageryProvider(e.layer),e.provider._position=e.props.position,void 0!==t.options.opacity&&(e.provider.alpha=t.options.opacity)),t.map.scene.requestRender()})),S(w(e),"addLayer",(function(t){if(e.layer&&!e.layer.detached&&(e.addLayerInternal(t),e.props.options.refresh&&e.layer.updateParams)){var r=0;e.refreshTimer=setInterval((function(){var o=e.layer.updateParams(s()({},e.props.options.params,{_refreshCounter:r++}));e.removeLayer(),e.layer=o,e.addLayerInternal(t),e.props.map.scene.requestRender()}),e.props.options.refresh)}})),S(w(e),"removeLayer",(function(t){var r,o,n=t||e.provider;n&&e.props.map.imageryLayers.remove(n),null!==(r=e.layer)&&void 0!==r&&r.detached&&null!==(o=e.layer)&&void 0!==o&&o.remove&&e.layer.remove(),e.props.map.scene.requestRender()})),e}return t=l,(r=[{key:"componentDidMount",value:function(){this.createLayer(this.props.type,this.props.options,this.props.position,this.props.map,this.props.securityToken),this.props.options&&this.layer&&this.getVisibilityOption(this.props)&&(this.addLayer(this.props),this.updateZIndex())}},{key:"UNSAFE_componentWillReceiveProps",value:function(e){var t=this;this.setLayerVisibility(e);var r=e.options&&void 0!==e.options.opacity?e.options.opacity:1;if(this.setLayerOpacity(r),e.position!==this.props.position&&(this.updateZIndex(e.position),this.provider&&(this.provider._position=e.position)),this.props.options&&this.props.options.params&&this.layer.updateParams&&e.options.visibility&&Object.keys(this.props.options.params).reduce((function(r,o){return e.options.params[o]!==t.props.options.params[o]||r}),!1)){var o=this.provider,n=this.layer.updateParams(e.options.params);this.layer=n,this.addLayer(e),setTimeout((function(){t.removeLayer(o)}),1e3)}this.updateLayer(e,this.props)}},{key:"componentWillUnmount",value:function(){var e;this.layer&&this.props.map&&!this.props.map.isDestroyed()&&(this.layer.detached&&null!==(e=this.layer)&&void 0!==e&&e.remove?this.layer.remove():(this.layer.destroy&&this.layer.destroy(),this.props.map.imageryLayers.remove(this.provider)),this.refreshTimer&&clearInterval(this.refreshTimer))}},{key:"render",value:function(){var e=this;if(this.props.children){var t=this.layer,r=t?n().Children.map(this.props.children,(function(r){return r?n().cloneElement(r,{container:t,styleName:e.props.options&&e.props.options.styleName}):null})):null;return n().createElement(n().Fragment,null,r)}return i.default.renderLayer(this.props.type,this.props.options,this.props.map,this.props.map.id,this.layer)}}])&&O(t.prototype,r),Object.defineProperty(t,"prototype",{writable:!1}),l}(n().Component);S(C,"propTypes",{map:l().object,type:l().string,options:l().object,onCreationError:l().func,position:l().number,securityToken:l().string,zoom:l().number});const j=C},462431:(e,t,r)=>{"use strict";r.d(t,{Z:()=>x});var o=r(376180),n=(r(319683),r(508665),r(169819)),i=r(675263),a=r.n(i),s=r(49977),p=r.n(s),l=r(124852),u=r.n(l),c=r(180307),d=r.n(c),m=r(737275);const f=function(e,t){var r=e.scene,n=t.position||t.endPosition;if(!n)return null;if(e.scene.drillPick(n).find((function(e){var t,r,o;return!(!1===(null==e||null===(t=e.id)||void 0===t||null===(r=t.entityCollection)||void 0===r||null===(o=r.owner)||void 0===o?void 0:o.queryable))}))){var i=r.globe.depthTestAgainstTerrain,a=r.pickTranslucentDepth;r.globe.depthTestAgainstTerrain=!0,r.pickTranslucentDepth=!0;var s=r.pickPosition(n);if(r.globe.depthTestAgainstTerrain=i,r.pickTranslucentDepth=a,s)return o.Cartographic.fromCartesian(s)}var p=e.camera.getPickRay(n),l=e.scene.globe.pick(p,e.scene),u=r._globe.ellipsoid;if(o.defined(l)){var c=u.cartesianToCartographic(l),d=function(e,t){if(null!==t.position){var r=e.scene,o=r._globe.ellipsoid;return r.camera.pickEllipsoid(t.position||t.endPosition,o)}return null}(e,t);return d&&(c.height=r._globe.getHeight(c),c.cartesian=d,c.position=l),c}return null};var h=r(552259),y=r(719824),v=r(737295),g=r.n(v),b=r(823493),O=r.n(b),P=r(618446),w=r.n(P),E=["type"];function S(e){return S="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},S(e)}function T(){return T=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var o in r)Object.prototype.hasOwnProperty.call(r,o)&&(e[o]=r[o])}return e},T.apply(this,arguments)}function C(e,t){if(e){if("string"==typeof e)return j(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?j(e,t):void 0}}function j(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,o=new Array(t);r<t;r++)o[r]=e[r];return o}function k(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,o)}return r}function _(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?k(Object(r),!0).forEach((function(t){A(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):k(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function M(e,t){for(var r=0;r<t.length;r++){var o=t[r];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,F(o.key),o)}}function I(e,t){return I=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},I(e,t)}function L(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function R(e){return R=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},R(e)}function A(e,t,r){return(t=F(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function F(e){var t=function(e,t){if("object"!==S(e)||null===e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var o=r.call(e,"string");if("object"!==S(o))return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"===S(t)?t:String(t)}var D=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&I(e,t)}(l,e);var t,r,i,a,s=(i=l,a=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,t=R(i);if(a){var r=R(this).constructor;e=Reflect.construct(t,arguments,r)}else e=t.apply(this,arguments);return function(e,t){if(t&&("object"===S(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return L(e)}(this,e)});function l(){var e;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,l);for(var t=arguments.length,r=new Array(t),n=0;n<t;n++)r[n]=arguments[n];return A(L(e=s.call.apply(s,[this].concat(r))),"state",{renderError:null}),A(L(e),"onClick",(function(t,r){if(e.props.onClick&&null!==r.position){var n=t.camera.pickEllipsoid(r.position,t.scene.globe.ellipsoid),i=e.getIntersectedFeatures(t,r.position),a=f(t,r)||n&&o.Cartographic.fromCartesian(n);if(a){var s=180*a.latitude/Math.PI,p=180*a.longitude/Math.PI,l=(90-s)/180*e.props.standardHeight*(e.props.zoom+1),u=(180+p)/360*e.props.standardWidth*(e.props.zoom+1);e.props.onClick({pixel:{x:u,y:l},height:e.props.mapOptions&&e.props.mapOptions.terrainProvider||i.length>0?a.height:void 0,cartographic:a,latlng:{lat:s,lng:p},crs:"EPSG:4326",intersectedFeatures:i,resolution:(0,h.getResolutions)()[Math.round(e.props.zoom)]})}}})),A(L(e),"onMouseMove",(function(t){var r;if(e.props.onMouseMove&&t.endPosition&&null!==(r=e.map)&&void 0!==r&&r.camera){var n=e.map.camera.pickEllipsoid(t.endPosition,e.map.scene.globe.ellipsoid),i=f(e.map,t)||n&&o.Cartographic.fromCartesian(n);if(i){var a=Math.round(i.height);e.props.onMouseMove({y:180*i.latitude/Math.PI,x:180*i.longitude/Math.PI,z:a,crs:"EPSG:4326"})}}})),A(L(e),"getDocument",(function(){return e.props.document||document})),A(L(e),"getMapOptions",(function(e){var t={};if(e.terrainProvider){var r=e.terrainProvider,n=r.type,i=function(e,t){if(null==e)return{};var r,o,n=function(e,t){if(null==e)return{};var r,o,n={},i=Object.keys(e);for(o=0;o<i.length;o++)r=i[o],t.indexOf(r)>=0||(n[r]=e[r]);return n}(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(o=0;o<i.length;o++)r=i[o],t.indexOf(r)>=0||Object.prototype.propertyIsEnumerable.call(e,r)&&(n[r]=e[r])}return n}(r,E);switch(n){case"cesium":t.terrainProvider=new o.CesiumTerrainProvider(i);break;case"ellipsoid":t.terrainProvider=new o.EllipsoidTerrainProvider}}return g()({},e,t)})),A(L(e),"getCenter",(function(){var t=e.map.scene.globe.pick(new o.Ray(e.map.camera.position,e.map.camera.direction),e.map.scene);t||(t=o.Cartesian3.add(o.Cartesian3.clone(e.map.camera.position),o.Cartesian3.multiplyByScalar(o.Cartesian3.clone(e.map.camera.direction),1e5,new o.Cartesian3),new o.Cartesian3));var r=o.Cartographic.fromCartesian(new o.Cartesian3(t.x,t.y,t.z));return{longitude:o.Math.toDegrees(r.longitude),latitude:o.Math.toDegrees(r.latitude),height:r.height}})),A(L(e),"getZoomFromHeight",(function(t){return Math.log2(e.props.zoomToHeight/t)+1})),A(L(e),"getHeightFromZoom",(function(t){return e.props.zoomToHeight/Math.pow(2,t-1)})),A(L(e),"getIntersectedFeatures",(function(e,t){var r=e.scene.drillPick(t).filter((function(e){var t,r,o;return!(!1===(null==e||null===(t=e.id)||void 0===t||null===(r=t.entityCollection)||void 0===r||null===(o=r.owner)||void 0===o?void 0:o.queryable))}));if(r){var n=r.reduce((function(e,t){var r,n,i,a;if(t instanceof o.Cesium3DTileFeature&&null!=t&&null!==(r=t.tileset)&&void 0!==r&&r.msId){n=t.tileset.msId;var s=t.getPropertyNames();i=Object.fromEntries(s.map((function(e){return[e,t.getProperty(e)]})))}else if((null==t?void 0:t.id)instanceof o.Entity&&t.id.id&&t.id.properties){var p=t.id,l=p.properties.propertyNames,u=p.entityCollection.owner.name;i=Object.fromEntries(l.map((function(e){return[e,t.id.properties[e].getValue(0)]}))),n=u}return i&&n?_(_({},e),{},A({},n,e[n]?[].concat(function(e){if(Array.isArray(e))return j(e)}(a=e[n])||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(a)||C(a)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}(),[{type:"Feature",properties:i,geometry:null}]):[{type:"Feature",properties:i,geometry:null}])):e}),[]);return Object.keys(n).map((function(e){return{id:e,features:n[e]}}))}return[]})),A(L(e),"gestureStartListener",(function(e){e.preventDefault()})),A(L(e),"setMousePointer",(function(t){e.map&&(d().findDOMNode(L(e)).getElementsByClassName("cesium-viewer")[0].style.cursor=t||"auto")})),A(L(e),"_updateMapPositionFromNewProps",(function(t){var r=e.getCenter(),n=e.map.camera.positionCartographic,i=e.getZoomFromHeight(n.height),a=function(e,t){return void 0!==e&&void 0!==t&&e.toFixed(12)-t.toFixed(12)<=1e-12},s=!a(t.center.x,r.longitude)||!a(t.center.y,r.latitude),p=t.zoom!==i;if(s||p){var l,u,c,d,m,f,h,y,v,g,b={destination:o.Cartesian3.fromDegrees(null!==(l=null===(u=t.viewerOptions)||void 0===u||null===(c=u.cameraPosition)||void 0===c?void 0:c.longitude)&&void 0!==l?l:t.center.x,null!==(d=null===(m=t.viewerOptions)||void 0===m||null===(f=m.cameraPosition)||void 0===f?void 0:f.latitude)&&void 0!==d?d:t.center.y,null!==(h=null===(y=t.viewerOptions)||void 0===y||null===(v=y.cameraPosition)||void 0===v?void 0:v.height)&&void 0!==h?h:e.getHeightFromZoom(t.zoom)),orientation:null===(g=t.viewerOptions)||void 0===g?void 0:g.orientation};e.setView(b)}})),A(L(e),"setView",(function(t){e.map.camera.cancelFlight(),e.map.camera.setView(t)})),A(L(e),"subscribeClickEvent",(function(t){var r={LEFT_UP:o.ScreenSpaceEventType.LEFT_UP,LEFT_DOWN:o.ScreenSpaceEventType.LEFT_DOWN,LEFT_CLICK:o.ScreenSpaceEventType.LEFT_CLICK,PINCH_START:o.ScreenSpaceEventType.PINCH_START,PINCH_END:o.ScreenSpaceEventType.PINCH_END,PINCH_MOVE:o.ScreenSpaceEventType.PINCH_MOVE},n=new(p().Subject),i=new(p().Subject);Object.keys(r).forEach((function(t){return e.hand.setInputAction((function(e){i.next({type:r[t],movement:e}),n.next({type:r[t],movement:e})}),r[t])})),i.filter((function(e){return e.type===r.PINCH_END})).switchMap((function(){return p().Observable.of(!0).concat(p().Observable.of(!1).delay(500))})).startWith(!1).switchMap((function(e){return e?p().Observable.never():n})).filter((function(e){return e.type===r.LEFT_DOWN})).switchMap((function(e){var t=e.movement;return n.filter((function(e){return e.type===r.LEFT_CLICK})).takeUntil(p().Observable.timer(500).merge(n.filter((function(e){return e.type!==r.LEFT_UP&&e.type!==r.LEFT_CLICK||e.type===r.LEFT_UP&&(o=t&&t.position,n=e.movement&&e.movement.position,!(o&&n&&o.x===n.x&&o.y===n.y));var o,n}))))})).subscribe((function(r){var o=r.movement;return e.onClick(t,o)})),e.clickStream$=n,e.pauserStream$=i})),A(L(e),"registerHooks",(function(){e.props.hookRegister.registerHook(h.GET_PIXEL_FROM_COORDINATES_HOOK),e.props.hookRegister.registerHook(h.GET_COORDINATES_FROM_PIXEL_HOOK),e.props.hookRegister.registerHook(h.ZOOM_TO_EXTENT_HOOK,(function(t){var r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=r.crs,i=r.duration,a=(0,y.reprojectBbox)(t,n,"EPSG:4326");if(e.map.camera.flyTo){var s=o.Rectangle.fromDegrees(a[0],a[1],a[2],a[3]);e.map.camera.flyTo({destination:s,duration:i,complete:e.updateMapInfoState})}}))})),A(L(e),"updateMapInfoState",(function(){var t=e.getCenter(),r=e.map.camera.positionCartographic,n=e.getZoomFromHeight(r.height),i={height:Math.round(e.props.standardWidth*(n+1)),width:Math.round(e.props.standardHeight*(n+1))},a=e.map.camera.computeViewRectangle();e.props.onMapViewChanges({x:t.longitude,y:t.latitude,crs:"EPSG:4326"},n,{bounds:a?{minx:o.Math.toDegrees(a.west),miny:o.Math.toDegrees(a.south),maxx:o.Math.toDegrees(a.east),maxy:o.Math.toDegrees(a.north)}:{minx:-180,miny:-90,maxx:180,maxy:90},crs:"EPSG:4326",rotation:0},i,e.props.id,e.props.projection,{cameraPosition:{longitude:o.Math.toDegrees(r.longitude),latitude:o.Math.toDegrees(r.latitude),height:r.height},orientation:{heading:e.map.camera.heading,pitch:e.map.camera.pitch,roll:e.map.camera.roll}},(0,h.getResolutions)()[n])})),A(L(e),"updateInteractions",(function(t){var r,o=_(_({},null===(r=t.mapOptions)||void 0===r?void 0:r.interactions),!t.interactive&&{dragPan:!1,mouseWheelZoom:!1});e.map.scene.screenSpaceCameraController.enableZoom=!(!1===o.mouseWheelZoom),e.map.scene.screenSpaceCameraController.enableRotate=!(!1===o.dragPan),e.map.scene.screenSpaceCameraController.enableTranslate=!(!1===o.dragPan),e.map.scene.screenSpaceCameraController.enableTilt=!(!1===o.dragPan)})),e}return t=l,(r=[{key:"UNSAFE_componentWillMount",value:function(){this.getDocument().addEventListener("gesturestart",this.gestureStartListener)}},{key:"componentDidMount",value:function(){var e,t,r,i,a,s,p,l,u,c,d,m,f,h,y,v,b,P,w,E,S,T,C=this,j=document.querySelector((null===(e=this.props.mapOptions)||void 0===e||null===(t=e.attribution)||void 0===t?void 0:t.container)||"#footer-attribution-container"),k=new o.Viewer(this.getDocument().getElementById(this.props.id),g()({imageryProvider:new o.OpenStreetMapImageryProvider,baseLayerPicker:!1,animation:!1,fullscreenButton:!1,geocoder:!1,homeButton:!1,infoBox:!1,sceneModePicker:!1,selectionIndicator:!1,timeline:!1,navigationHelpButton:!1,navigationInstructionsInitiallyVisible:!1,creditContainer:j||void 0,requestRenderMode:!0,maximumRenderTimeChange:1/0,skyBox:!1},this.getMapOptions(this.props.mapOptions)));k.screenSpaceEventHandler.removeInputAction(o.ScreenSpaceEventType.LEFT_DOUBLE_CLICK),this.props.errorPanel&&(k.cesiumWidget.showErrorPanel=function(e,t,r){C.setState({renderError:{title:e,message:t,error:r}})}),this.props.registerHooks&&this.registerHooks(),!1!==(null===(r=this.props.mapOptions)||void 0===r?void 0:r.navigationTools)&&k.extend(n.Z,{enableCompass:null===(T=this.props.mapOptions)||void 0===T?void 0:T.navigationTools,enableZoomControls:!1,enableDistanceLegend:!1}),k.scene.globe.baseColor=o.Color.WHITE,k.imageryLayers.removeAll(),k.camera.moveEnd.addEventListener(this.updateMapInfoState),this.hand=new o.ScreenSpaceEventHandler(k.scene.canvas),this.subscribeClickEvent(k),this.hand.setInputAction(O()(this.onMouseMove.bind(this),500),o.ScreenSpaceEventType.MOUSE_MOVE),k.camera.setView({destination:o.Cartesian3.fromDegrees(null!==(i=null===(a=this.props.viewerOptions)||void 0===a||null===(s=a.cameraPosition)||void 0===s?void 0:s.longitude)&&void 0!==i?i:this.props.center.x,null!==(p=null===(l=this.props.viewerOptions)||void 0===l||null===(u=l.cameraPosition)||void 0===u?void 0:u.latitude)&&void 0!==p?p:this.props.center.y,null!==(c=null===(d=this.props.viewerOptions)||void 0===d||null===(m=d.cameraPosition)||void 0===m?void 0:m.height)&&void 0!==c?c:this.getHeightFromZoom(this.props.zoom)),orientation:null===(f=this.props.viewerOptions)||void 0===f?void 0:f.orientation}),this.setMousePointer(this.props.mousePointer),this.map=k;var _=this.map.scene;this.updateInteractions(this.props),_.skyAtmosphere.show=null===(h=null===(y=this.props.mapOptions)||void 0===y?void 0:y.showSkyAtmosphere)||void 0===h||h,_.fog.enabled=null!==(v=null===(b=this.props.mapOptions)||void 0===b?void 0:b.enableFog)&&void 0!==v&&v,_.globe.showGroundAtmosphere=null!==(P=null===(w=this.props.mapOptions)||void 0===w?void 0:w.showGroundAtmosphere)&&void 0!==P&&P,_.globe.depthTestAgainstTerrain=null!==(E=null===(S=this.props.mapOptions)||void 0===S?void 0:S.depthTestAgainstTerrain)&&void 0!==E&&E,this.forceUpdate(),k.scene.requestRender()}},{key:"UNSAFE_componentWillReceiveProps",value:function(e){return e.mousePointer!==this.props.mousePointer&&this.setMousePointer(e.mousePointer),e.mapStateSource!==this.props.id&&this._updateMapPositionFromNewProps(e),!1}},{key:"componentDidUpdate",value:function(e){var t,r,n,i,a,s,p,l;if(null!==(t=this.props)&&void 0!==t&&t.orientate&&e&&!w()(this.props.orientate,null==e?void 0:e.orientate)){var u={destination:o.Cartesian3.fromDegrees(parseFloat(this.props.orientate.x),parseFloat(this.props.orientate.y),this.getHeightFromZoom(parseFloat(this.props.orientate.z))),orientation:{heading:parseFloat(this.props.orientate.heading),pitch:parseFloat(this.props.orientate.pitch),roll:parseFloat(this.props.orientate.roll)}};this.map.camera.cancelFlight(),this.map.camera.flyTo(u,this.props.mapOptions.defaultFlightOptions)}e&&this.props.mapOptions.showSkyAtmosphere!==(null==e||null===(r=e.mapOptions)||void 0===r?void 0:r.showSkyAtmosphere)&&(this.map.scene.skyAtmosphere.show=this.props.mapOptions.showSkyAtmosphere),e&&this.props.mapOptions.showGroundAtmosphere!==(null==e||null===(n=e.mapOptions)||void 0===n?void 0:n.showGroundAtmosphere)&&(this.map.scene.globe.showGroundAtmosphere=this.props.mapOptions.showGroundAtmosphere),e&&this.props.mapOptions.enableFog!==(null==e||null===(i=e.mapOptions)||void 0===i?void 0:i.enableFog)&&(this.map.scene.fog.enabled=this.props.mapOptions.enableFog),e&&this.props.mapOptions.depthTestAgainstTerrain!==(null==e||null===(a=e.mapOptions)||void 0===a?void 0:a.depthTestAgainstTerrain)&&(this.map.scene.globe.depthTestAgainstTerrain=this.props.mapOptions.depthTestAgainstTerrain),(null==e?void 0:e.interactive)===this.props.interactive&&w()(null==e||null===(s=e.mapOptions)||void 0===s?void 0:s.interactions,null===(p=this.props)||void 0===p||null===(l=p.mapOptions)||void 0===l?void 0:l.interactions)||this.updateInteractions(this.props)}},{key:"componentWillUnmount",value:function(){var e,t;this.clickStream$.complete(),this.pauserStream$.complete(),this.hand.destroy(),this.getDocument().removeEventListener("gesturestart",this.gestureStartListener),null!==(e=this.map)&&void 0!==e&&null!==(t=e.cesiumNavigation)&&void 0!==t&&t.destroy&&this.map.cesiumNavigation.destroy(),this.map.destroy()}},{key:"render",value:function(){var e,t=this,r=this.map,o=this.props.projection,n=r?u().Children.map(this.props.children,(function(e){return e?u().cloneElement(e,{map:r,projection:o,onCreationError:t.props.onCreationError,zoom:t.props.zoom}):null})):null,i=this.props.errorPanel;return u().createElement("div",{id:this.props.id,style:this.props.style},n,i?u().createElement(i,{show:!!this.state.renderError,error:null===(e=this.state.renderError)||void 0===e?void 0:e.error,onReload:function(){return t.props.onReload()}}):null)}}])&&M(t.prototype,r),Object.defineProperty(t,"prototype",{writable:!1}),l}(u().Component);A(D,"propTypes",{id:a().string,document:a().object,center:m.ZP.PropTypes.center,zoom:a().number.isRequired,mapStateSource:m.ZP.PropTypes.mapStateSource,projection:a().string,onMapViewChanges:a().func,onCreationError:a().func,onClick:a().func,onMouseMove:a().func,mapOptions:a().object,standardWidth:a().number,standardHeight:a().number,mousePointer:a().string,zoomToHeight:a().number,registerHooks:a().bool,hookRegister:a().object,viewerOptions:a().object,orientate:a().object,zoomControl:a().bool,errorPanel:a().func,onReload:a().func,style:a().object,interactive:a().bool}),A(D,"defaultProps",{id:"map",onMapViewChanges:function(){},onClick:function(){},onCreationError:function(){},projection:"EPSG:3857",mapOptions:{},standardWidth:512,standardHeight:512,zoomToHeight:8e7,registerHooks:!0,hookRegister:{registerHook:h.registerHook},orientate:void 0,viewerOptions:{orientation:{heading:0,pitch:-1*Math.PI/2,roll:0}},onReload:function(){},interactive:!0});const x=(0,l.forwardRef)((function(e,t){var r,o,n=(r=(0,l.useState)(1),o=2,function(e){if(Array.isArray(e))return e}(r)||function(e,t){var r=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=r){var o,n,i,a,s=[],p=!0,l=!1;try{if(i=(r=r.call(e)).next,0===t){if(Object(r)!==r)return;p=!1}else for(;!(p=(o=i.call(r)).done)&&(s.push(o.value),s.length!==t);p=!0);}catch(e){l=!0,n=e}finally{try{if(!p&&null!=r.return&&(a=r.return(),Object(a)!==a))return}finally{if(l)throw n}}return s}}(r,o)||C(r,o)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()),i=n[0],a=n[1];return u().createElement(D,T({key:i,ref:t},e,{onReload:function(){return a(i+1)}}))}))}}]);