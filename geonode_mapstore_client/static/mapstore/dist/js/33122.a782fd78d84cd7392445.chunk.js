(self.webpackChunkgeonode_mapstore_client=self.webpackChunkgeonode_mapstore_client||[]).push([[33122],{223502:(e,r,t)=>{"use strict";t.d(r,{$:()=>s,b:()=>u});var o=t(737275),i=t(701469),n=t.n(i),l=t(513218),a=t.n(l),s=function e(r){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(n()(r))return r.reduce((function(r,t){return e(t)&&r}),!0);var i=!1,l=!(0===r.indexOf("http")),s=!l&&r.match(/([^:]*:)\/\/([^:]*:?[^@]*@)?([^:\/\?]*):?([^\/\?]*)/);if(s){var u=window.location;l=s[1]===u.protocol&&s[3]===u.hostname;var c=s[4],f=u.port;(80!==c&&""!==c||"80"!==f&&""!==f)&&(l=l&&c===f)}if(!l){var d=o.ZP.getProxyUrl(t);if(d){var p=[];a()(d)&&(p=d.useCORS||[],d=d.url),p.reduce((function(e,t){return e||0===r.indexOf(t)}),!1)||(i=!0)}}return i},u=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},r=o.ZP.getProxyUrl(e);return r&&a()(r)&&(r=r.url),r}},833122:(e,r,t)=>{"use strict";t.r(r),t.d(r,{default:()=>G});var o=t(376180),i=t(65792),n=t.n(i),l=t(984596),a=t.n(l),s=t(281763),u=t.n(s),c=t(441609),f=t.n(c),d=t(618446),p=t.n(d),m=t(478718),y=t.n(m),h=t(396026),v=t.n(h),b=t(223502);function g(e){return g="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},g(e)}function S(e,r){for(var t=0;t<r.length;t++){var o=r[t];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,P(o.key),o)}}function w(e,r){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);r&&(o=o.filter((function(r){return Object.getOwnPropertyDescriptor(e,r).enumerable}))),t.push.apply(t,o)}return t}function T(e){for(var r=1;r<arguments.length;r++){var t=null!=arguments[r]?arguments[r]:{};r%2?w(Object(t),!0).forEach((function(r){O(e,r,t[r])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):w(Object(t)).forEach((function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(t,r))}))}return e}function O(e,r,t){return(r=P(r))in e?Object.defineProperty(e,r,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[r]=t,e}function P(e){var r=function(e,r){if("object"!==g(e)||null===e)return e;var t=e[Symbol.toPrimitive];if(void 0!==t){var o=t.call(e,"string");if("object"!==g(o))return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"===g(r)?r:String(r)}function C(e){return function(e){if(Array.isArray(e))return I(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||_(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function _(e,r){if(e){if("string"==typeof e)return I(e,r);var t=Object.prototype.toString.call(e).slice(8,-1);return"Object"===t&&e.constructor&&(t=e.constructor.name),"Map"===t||"Set"===t?Array.from(e):"Arguments"===t||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t)?I(e,r):void 0}}function I(e,r){(null==r||r>e.length)&&(r=e.length);for(var t=0,o=new Array(r);t<r;t++)o[t]=e[t];return o}function R(e){var r,t,i=e.color,l=e.opacity,a=(r=n()(i).gl(),t=4,function(e){if(Array.isArray(e))return e}(r)||function(e,r){var t=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=t){var o,i,n,l,a=[],s=!0,u=!1;try{if(n=(t=t.call(e)).next,0===r){if(Object(t)!==t)return;s=!1}else for(;!(s=(o=n.call(t)).done)&&(a.push(o.value),a.length!==r);s=!0);}catch(e){u=!0,i=e}finally{try{if(!s&&null!=t.return&&(l=t.return(),Object(l)!==l))return}finally{if(u)throw i}}return a}}(r,t)||_(r,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()),s=a[0],u=a[1],c=a[2],f=a[3];return void 0!==l?new o.Color(s,u,c,l):new o.Color(s,u,c,f)}function z(e){var r=e.color,t=e.opacity,i=e.dasharray;if((null==i?void 0:i.length)<=0)return R({color:r,opacity:t});var n=i.reduce((function(e,r){return e+r}),0);return new o.PolylineDashMaterialProperty({color:R({color:r,opacity:t}),dashLength:n,dashPattern:parseInt(i.map((function(e){return Math.floor(e/n*16)})).map((function(e,r){return v()(e).map((function(){return r%2==0?"1":"0"})).join("")})).join(""),2)})}var E=function(e,r){var t;return(null!==(t=e._msGlobalOpacity)&&void 0!==t?t:1)!==r},j={};function L(e){var r,t,i=e.map,n=e.symbolizer,l=e.entity,a=e.globalOpacity,s=e.sampleTerrain,u=["msLeaderLineColor","msLeaderLineOpacity","msLeaderLineWidth","msHeight","msHeightReference","offset"];if(l._msSymbolizer&&!E(l,a)&&p()(y()(n,u),y()(l._msSymbolizer,u)))return Promise.resolve({polyline:l.polyline,billboard:l.billboard,updated:!1});if(!n.msLeaderLineWidth)return Promise.resolve({updated:void 0!==l.polyline});var c=o.Cartographic.fromCartesian(l.position.getValue(o.JulianDate.now())),f=n.msHeightReference;return((null==n?void 0:n.msHeight)===(null===(r=l._msSymbolizer)||void 0===r?void 0:r.msHeight)&&(null==n?void 0:n.msHeightReference)===(null===(t=l._msSymbolizer)||void 0===t?void 0:t.msHeightReference)&&l.polyline?Promise.resolve(l.polyline):function(e){var r=e.map,t=e.cartographic,i=e.heightReference,n=e.sampleTerrain;return new Promise((function(e){var l=function(r){var n={none:t.height,relative:t.height+r,clamp:r};e(r===t.height?void 0:o.Cartesian3.fromRadiansArrayHeights([t.longitude,t.latitude,r,t.longitude,t.latitude,n[null!=i?i:"none"]]))},a=null==r?void 0:r.terrainProvider;a?(a.ready?Promise.resolve(!0):a.readyPromise).then((function(){var e,r=null!=a&&a.availability?o.sampleTerrainMostDetailed(a,[new o.Cartographic(t.longitude,t.latitude,0)]):n(a,null!==(e=null==a?void 0:a.sampleTerrainZoomLevel)&&void 0!==e?e:18,[new o.Cartographic(t.longitude,t.latitude,0)]);o.defined(r)?r.then((function(e){var r,t;return l(null!==(r=null==e||null===(t=e[0])||void 0===t?void 0:t.height)&&void 0!==r?r:0)})).catch((function(){return l(0)})):l(0)})):l(0)}))}({map:i,cartographic:c,heightReference:f,sampleTerrain:s}).then((function(e){return new o.PolylineGraphics({positions:e})}))).then((function(e){var r,t,i=R({color:n.msLeaderLineColor||"#000000",opacity:(null!==(r=n.msLeaderLineOpacity)&&void 0!==r?r:1)*a});if(e&&(e.material=i,e.width=null!==(t=n.msLeaderLineWidth)&&void 0!==t?t:1),n.offset&&(0!==n.offset[0]||0!==n.offset[1])){var l=function(e){var r=e.offset,t=void 0===r?[]:r,o=e.msLeaderLineWidth,i=null!=o?o:1,n=Math.abs(t[0]||1),l=Math.abs(t[1]||1),a=Math.sign(t[0])===Math.sign(t[1]),s=[n,l,i,a].join(";");if(j[s])return j[s];var u=document.createElement("canvas");u.setAttribute("width",n),u.setAttribute("height",l);var c=u.getContext("2d");return c.strokeStyle="#ffffff",c.lineWidth=i,c.beginPath(),c.moveTo.apply(c,C(a?[0,0]:[n,0])),c.lineTo.apply(c,C(a?[n,l]:[0,l])),c.stroke(),j[s]=u,u}(n);return{billboard:new o.BillboardGraphics({image:l,scale:1,pixelOffset:new o.Cartesian2((n.offset[0]||0)/2,(n.offset[1]||0)/2),color:i}),polyline:e,updated:!0}}return{polyline:e,updated:!0}}))}function N(e){var r=e.entity,t=e.symbolizer,i=e.properties;r._msPosition||(r._msPosition=r.position.getValue(o.JulianDate.now()));var n=function(e,r){var t=parseFloat(e);if(!isNaN(t)&&u()(t))return t;var o="attribute"===(null==e?void 0:e.type)&&parseFloat(r[e.name]);return!isNaN(o)&&u()(o)?o:null}(t.msHeight,i);if(null!==n){var l=o.Cartographic.fromCartesian(r._msPosition);l.height=n,r.position.setValue(o.Cartographic.toCartesian(l))}else r.position.setValue(r._msPosition)}function k(e){var r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"";return e.properties?Object.keys(e.properties).reduce((function(r,t){var o,i=new RegExp("\\{\\{".concat(t,"\\}\\}"),"g");return r.replace(i,null!==(o=e.properties[t])&&void 0!==o?o:"")}),r):r}var F={none:"NONE",relative:"RELATIVE_TO_GROUND",clamp:"CLAMP_TO_GROUND"},M=["billboard","box","corridor","cylinder","ellipse","ellipsoid","label","model","tileset","path","plane","point","polygon","polyline","polylineVolume","rectangle","wall"];const G=function(){function e(){var r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=r.drawIcons,o=r.getImageIdFromSymbolizer,i=r.geoStylerStyleFilter;!function(e,r){if(!(e instanceof r))throw new TypeError("Cannot call a class as a function")}(this,e),this._drawIcons=t||function(){return Promise.resolve(null)},this._getImageIdFromSymbolizer=o||function(e){return e.symbolizerId},this._geoStylerStyleFilter=i||function(){return!0}}var r,t;return r=e,t=[{key:"readStyle",value:function(){return new Promise((function(e,r){try{e(null)}catch(e){r(e)}}))}},{key:"writeStyle",value:function(e){var r=this;return new Promise((function(t,i){try{r._drawIcons(e).then((function(){var i=function(){var e=(arguments.length>0&&void 0!==arguments[0]?arguments[0]:{}).rules,r=void 0===e?[]:e,t=arguments.length>1?arguments[1]:void 0,i=t.images,n=void 0===i?[]:i,l=t.getImageIdFromSymbolizer,s=t.geoStylerStyleFilter,u=void 0===s?function(){return!0}:s;return function(e){var t=e.entities,i=e.map,s=e.opacity,c=void 0===s?1:s,d=e.sampleTerrain,m=void 0===d?o.sampleTerrain:d;return Promise.all((t||[]).map((function(e){return new Promise((function(t){var s,d={};M.forEach((function(r){e._msStoredCoordinates||(d[r]=function(e,r){var t,o;switch(e){case"polyline":return null===(t=r[e])||void 0===t?void 0:t.positions;case"polygon":return null===(o=r[e])||void 0===o?void 0:o.hierarchy;default:return null}}(r,e)||void 0)})),e._msStoredCoordinates||(e._msStoredCoordinates=d);var h=(null==e||null===(s=e.properties)||void 0===s?void 0:s.getValue(o.JulianDate.now()))||{},v=null==r?void 0:r.filter((function(e){return!e.filter||u({properties:h||{}},e.filter)}));if((null==v?void 0:v.length)>0){var g=v.reduce((function(e,r){return[].concat(C(e),C(null==r?void 0:r.symbolizers))}),[]),S=g.filter((function(r){return["Mark","Icon","Text","Model"].includes(r.kind)&&e.position})),w=g.filter((function(r){return"Line"===r.kind&&e._msStoredCoordinates.polyline})),O=g.filter((function(r){return"Fill"===r.kind&&e._msStoredCoordinates.polygon})),P=S[S.length-1]||w[w.length-1]||O[O.length-1];return!P||p()(P,e._msSymbolizer)&&!E(e,c)?(!P&&e._msSymbolizer&&(M.forEach((function(r){e[r]=void 0})),e._msSymbolizer=void 0,e._msGlobalOpacity=void 0),t(e)):function(e){var r=e.symbolizer,t=e.images,i=e.getImageIdFromSymbolizer,n=e.entity,l=e.globalOpacity,s=e.properties,u=e.map,c=e.sampleTerrain;if("Mark"===r.kind){N({entity:n,symbolizer:r,properties:s});var f=t.find((function(e){return e.id===i(r)}))||{},d=f.image,m=f.width,h=f.height;if(d){var v=m>h?m:h,g=2*r.radius/v;return L({map:u,symbolizer:r,entity:n,globalOpacity:l,sampleTerrain:c}).then((function(e){return{polyline:e.polyline,billboard:new o.BillboardGraphics({image:d,scale:g,rotation:o.Math.toRadians(-1*r.rotate||0),disableDepthTestDistance:r.msBringToFront?Number.POSITIVE_INFINITY:0,heightReference:o.HeightReference[F[r.msHeightReference]||"NONE"],color:R({color:"#ffffff",opacity:1*l})})}}))}}if("Icon"===r.kind){N({entity:n,symbolizer:r,properties:s});var S=t.find((function(e){return e.id===i(r)}))||{},w=S.image,O=S.width,P=S.height;if(w){var C=O>P?O:P,_=r.size/C;return L({map:u,symbolizer:r,entity:n,globalOpacity:l,sampleTerrain:c}).then((function(e){return{polyline:e.polyline,billboard:new o.BillboardGraphics({image:w,scale:_,rotation:o.Math.toRadians(-1*r.rotate||0),disableDepthTestDistance:r.msBringToFront?Number.POSITIVE_INFINITY:0,heightReference:o.HeightReference[F[r.msHeightReference]||"NONE"],color:R({color:"#ffffff",opacity:r.opacity*l})})}}))}}if("Text"===r.kind)return N({entity:n,symbolizer:r,properties:s}),L({map:u,symbolizer:r,entity:n,globalOpacity:l,sampleTerrain:c}).then((function(e){var t,i,n,u,c=e.polyline;return{billboard:e.billboard,polyline:c,label:new o.LabelGraphics(T({text:k({properties:s},r.label),font:[r.fontStyle,r.fontWeight,"".concat(r.size,"px"),a()(r.font||["serif"]).join(", ")].filter((function(e){return e})).join(" "),fillColor:R({color:r.color,opacity:1*l}),disableDepthTestDistance:r.msBringToFront?Number.POSITIVE_INFINITY:0,heightReference:o.HeightReference[F[r.msHeightReference]||"NONE"],pixelOffset:new o.Cartesian2(null!==(t=null==r||null===(i=r.offset)||void 0===i?void 0:i[0])&&void 0!==t?t:0,null!==(n=null==r||null===(u=r.offset)||void 0===u?void 0:u[1])&&void 0!==n?n:0)},r.haloWidth>0&&{style:o.LabelStyle.FILL_AND_OUTLINE,outlineColor:R({color:r.haloColor,opacity:1*l}),outlineWidth:r.haloWidth}))}}));if("Model"===r.kind){var I,E,j,M,G,D;if(null==r||!r.model)return Promise.resolve({});var H=["model"],x=n.model&&n._msSymbolizer&&p()(y()(r,H),y()(n._msSymbolizer,H)),A=x?n.model:new o.ModelGraphics({uri:new o.Resource({proxy:(0,b.$)(null==r?void 0:r.model)?new o.DefaultProxy((0,b.b)()):void 0,url:null==r?void 0:r.model})});N({entity:n,symbolizer:r,properties:s});var V=n._msPosition,W=o.Math.toRadians(null!==(I=null==r?void 0:r.heading)&&void 0!==I?I:0),B=o.Math.toRadians(null!==(E=null==r?void 0:r.pitch)&&void 0!==E?E:0),U=o.Math.toRadians(null!==(j=null==r?void 0:r.roll)&&void 0!==j?j:0),J=new o.HeadingPitchRoll(W,B,U),Y=o.Transforms.headingPitchRollQuaternion(V,J);return n.orientation=Y,A.scale=null!==(M=null==r?void 0:r.scale)&&void 0!==M?M:1,A.color=R({color:null!==(G=r.color)&&void 0!==G?G:"#ffffff",opacity:(null!==(D=r.opacity)&&void 0!==D?D:1)*l}),A.heightReference=o.HeightReference[F[r.msHeightReference]||"NONE"],L({map:u,symbolizer:r,entity:n,globalOpacity:l,sampleTerrain:c}).then((function(e){var r=e.polyline,t=e.updated;return T({},(!x||t)&&{model:A,polyline:r})}))}if("Line"===r.kind)return Promise.resolve({polyline:new o.PolylineGraphics({material:null!=r&&r.dasharray?z({color:r.color,opacity:r.opacity*l,dasharray:r.dasharray}):R({color:r.color,opacity:r.opacity*l}),width:r.width,positions:n._msStoredCoordinates.polyline,clampToGround:r.msClampToGround})});if("Fill"===r.kind){var Z,$=new o.PolygonGraphics(T({material:R({color:r.color,opacity:r.fillOpacity*l}),hierarchy:n._msStoredCoordinates.polygon,perPositionHeight:!r.msClampToGround},r.msClampToGround?{classificationType:"terrain"===r.msClassificationType?o.ClassificationType.TERRAIN:"3d"===r.msClassificationType?o.ClassificationType.CESIUM_3D_TILE:o.ClassificationType.BOTH}:void 0));return r.outlineColor&&0!==r.outlineWidth&&(Z=new o.PolylineGraphics(T({material:R({color:r.outlineColor,opacity:r.outlineOpacity*l}),width:r.outlineWidth,positions:n._msStoredCoordinates.polygon.getValue().positions,clampToGround:r.msClampToGround},r.msClampToGround?{classificationType:"terrain"===r.msClassificationType?o.ClassificationType.TERRAIN:"3d"===r.msClassificationType?o.ClassificationType.CESIUM_3D_TILE:o.ClassificationType.BOTH}:void 0))),Promise.resolve(T({polygon:$},Z&&{polyline:Z}))}return Promise.resolve({})}({symbolizer:P,images:n,getImageIdFromSymbolizer:l,entity:e,globalOpacity:c,properties:h,map:i,sampleTerrain:m}).then((function(r){f()(r)||(M.forEach((function(r){e[r]=void 0})),Object.keys(r).forEach((function(t){e[t]=r[t]}))),e._msSymbolizer=P,e._msGlobalOpacity=c,t(e)}))}return M.forEach((function(r){e[r]=void 0})),e._msSymbolizer=void 0,e._msGlobalOpacity=void 0,t(e)}))})))}}(e,{images:arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],getImageIdFromSymbolizer:r._getImageIdFromSymbolizer,geoStylerStyleFilter:r._geoStylerStyleFilter});t(i)}))}catch(e){i(e)}}))}}],t&&S(r.prototype,t),Object.defineProperty(r,"prototype",{writable:!1}),e}()},540098:e=>{var r=Math.ceil,t=Math.max;e.exports=function(e,o,i,n){for(var l=-1,a=t(r((o-e)/(i||1)),0),s=Array(a);a--;)s[n?a:++l]=e,e+=i;return s}},747445:(e,r,t)=>{var o=t(540098),i=t(816612),n=t(418601);e.exports=function(e){return function(r,t,l){return l&&"number"!=typeof l&&i(r,t,l)&&(t=l=void 0),r=n(r),void 0===t?(t=r,r=0):t=n(t),l=void 0===l?r<t?1:-1:n(l),o(r,t,l,e)}}},396026:(e,r,t)=>{var o=t(747445)();e.exports=o}}]);