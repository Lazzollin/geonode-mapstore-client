(self.webpackChunkgeonode_mapstore_client=self.webpackChunkgeonode_mapstore_client||[]).push([[9061],{394943:(t,e,r)=>{"use strict";r.d(e,{ZP:()=>at});var n=r(49977),a=r.n(n),o=r(227361),l=r.n(o),s=r(91175),i=r.n(s),u=r(701469),c=r.n(u),y=r(941106),f=r.n(y),b=r(545578),m=r.n(b),d=r(197395),p=r(580416),v=r(460604),g=r(690825),S=r(680833),h=r(782904),O=r(624262),w=r(577215),j=r(396909),N=r(409082),E=r(375875),T=r.n(E),P=r(984596),U=r.n(P),D=r(99009);function k(t){return k="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},k(t)}function M(t){return function(t){if(Array.isArray(t))return W(t)}(t)||function(t){if("undefined"!=typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}(t)||function(t,e){if(t){if("string"==typeof t)return W(t,e);var r=Object.prototype.toString.call(t).slice(8,-1);return"Object"===r&&t.constructor&&(r=t.constructor.name),"Map"===r||"Set"===r?Array.from(t):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?W(t,e):void 0}}(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function W(t,e){(null==e||e>t.length)&&(e=t.length);for(var r=0,n=new Array(e);r<e;r++)n[r]=t[r];return n}function I(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),r.push.apply(r,n)}return r}function V(t){for(var e=1;e<arguments.length;e++){var r=null!=arguments[e]?arguments[e]:{};e%2?I(Object(r),!0).forEach((function(e){A(t,e,r[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):I(Object(r)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(r,e))}))}return t}function A(t,e,r){return(e=function(t){var e=function(t,e){if("object"!==k(t)||null===t)return t;var r=t[Symbol.toPrimitive];if(void 0!==r){var n=r.call(t,"string");if("object"!==k(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"===k(e)?e:String(e)}(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}const x=function(t,e,r){var n=t+"layers/"+e+".json";return T().get(n,r).then((function(t){return t.data&&t.data.layer}))},F=function(t){var e=t.baseUrl,r=t.layerName,n=t.styles,a=void 0===n?[]:n,o=t.options,l=void 0===o?{}:o,s=(0,D.$N)(r),i=s.name,u=s.workspace,c="".concat(e,"rest/").concat(u&&"workspaces/".concat(u,"/")||"","layers/").concat(i,".json");return T().get(c,l).then((function(t){var e=t.data.layer||{},r=e.styles&&e.styles.style&&U()(e.styles.style)||[],n=a.map((function(t){return t.name})),o=r.filter((function(t){var e=t.name;return-1===n.indexOf(e)}));return{layer:V(V({},e),{},{styles:{"@class":"linked-hash-set",style:o}})}})).then((function(t){return T().put(c,t).then((function(){return t}))}))},$=function(t){var e=t.baseUrl,r=t.layerName,n=t.styles,a=void 0===n?[]:n,o=t.options,l=void 0===o?{}:o,s=(0,D.$N)(r),i=s.name,u=s.workspace,c="".concat(e,"rest/").concat(u&&"workspaces/".concat(u,"/")||"","layers/").concat(i,".json");return T().get(c,l).then((function(t){var e=t.data.layer||{},r=e.styles&&e.styles.style&&U()(e.styles.style)||[];return{layer:V(V({},e),{},{styles:{"@class":"linked-hash-set",style:[].concat(M(r),M(a))}})}})).then((function(t){return T().put(c,t).then((function(){return t}))}))},Z=function(t){var e=t.baseUrl,r=t.layerName,n=t.styleName,a=t.options,o=void 0===a?{}:a,l=(0,D.$N)(r),s=l.name,i=l.workspace,u="".concat(e,"rest/").concat(i&&"workspaces/".concat(i,"/")||"","layers/").concat(s,".json");return T().get(u,o).then((function(t){var e=t.data.layer||{},r=e.styles&&e.styles.style&&U()(e.styles.style)||[],a=e.defaultStyle||{},o=m()([a].concat(M(r)),"name");return{layer:V(V({},e),{},{defaultStyle:{name:n},styles:{"@class":"linked-hash-set",style:o}})}})).then((function(t){return T().put(u,t).then((function(){return t}))}))};var L=r(893222),B=r(206273),C=r(607147),X=r(108954);function _(t){return _="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},_(t)}var z=["name","workspace"];function J(t){return function(t){if(Array.isArray(t))return Q(t)}(t)||function(t){if("undefined"!=typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}(t)||q(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function R(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),r.push.apply(r,n)}return r}function K(t){for(var e=1;e<arguments.length;e++){var r=null!=arguments[e]?arguments[e]:{};e%2?R(Object(r),!0).forEach((function(e){G(t,e,r[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):R(Object(r)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(r,e))}))}return t}function G(t,e,r){return(e=function(t){var e=function(t,e){if("object"!==_(t)||null===t)return t;var r=t[Symbol.toPrimitive];if(void 0!==r){var n=r.call(t,"string");if("object"!==_(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"===_(e)?e:String(e)}(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function H(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){var r=null==t?null:"undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(null!=r){var n,a,o,l,s=[],i=!0,u=!1;try{if(o=(r=r.call(t)).next,0===e){if(Object(r)!==r)return;i=!1}else for(;!(i=(n=o.call(r)).done)&&(s.push(n.value),s.length!==e);i=!0);}catch(t){u=!0,a=t}finally{try{if(!i&&null!=r.return&&(l=r.return(),Object(l)!==l))return}finally{if(u)throw a}}return s}}(t,e)||q(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function q(t,e){if(t){if("string"==typeof t)return Q(t,e);var r=Object.prototype.toString.call(t).slice(8,-1);return"Object"===r&&t.constructor&&(r=t.constructor.name),"Map"===r||"Set"===r?Array.from(t):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?Q(t,e):void 0}}function Q(t,e){(null==e||e>t.length)&&(e=t.length);for(var r=0,n=new Array(e);r<e;r++)n[r]=t[r];return n}var Y=function(t){var e=t.status,r=t.styleName,n=t.baseUrl;return"edit"===e?a().Observable.defer((function(){return N.ZP.getStyleCodeByName({baseUrl:n,styleName:r}).then((function(t){return(0,D.co)(t).then((function(e){return[t,e]})).catch((function(){return[t,!1]}))}))})).switchMap((function(t){var e,r,n=H(t,2),o=n[0],l=n[1];return a().Observable.of((0,j.FU)({languageVersion:o.languageVersion,code:o.code,templateId:"",format:o.format,init:!0}),(0,j.bB)(l?{editorType:"textarea",styleJSON:null}:{editorType:(null==o||null===(e=o.metadata)||void 0===e?void 0:e.msEditorType)||"textarea",styleJSON:null==o||null===(r=o.metadata)||void 0===r?void 0:r.msStyleJSON}))})).catch((function(t){return a().Observable.of((0,j.Fe)("edit",t))})):a().Observable.empty()},tt=function(t){var e=t.styleName,r=t.baseUrl,n=t.onSuccess$,o=t.onError$;return a().Observable.defer((function(){return N.ZP.deleteStyle({baseUrl:r,styleName:e})})).switchMap((function(){return n||a().Observable.empty()})).catch((function(){return o||a().Observable.empty()}))},et=function(t){var e=t.baseUrl,r=t.update,n=t.code,o=t.format,l=t.styleName,s=t.status,i=t.languageVersion,u=t.options,y=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],f=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[];return a().Observable.defer((function(){return N.ZP[r?"updateStyle":"createStyle"]({baseUrl:e,code:n,format:o,styleName:l,languageVersion:i,options:u})})).switchMap((function(){var t;return c()(y)&&(t=a().Observable).of.apply(t,[(0,j.Wm)()].concat(J(y)))||y})).catch((function(t){var e;return(e=a().Observable).of.apply(e,[(0,j.Fe)(s,t),(0,j.Wm)()].concat(J(f)))})).startWith((0,j.pt)(s))};function rt(t,e){return!e&&t.availableStyles?a().Observable.of((0,p.Xy)({availableStyles:t.availableStyles}),(0,j.Wm)()):(0,S.kB)(t).switchMap((function(e){var r=(0,w.Br)(e);return r.availableStyles?a().Observable.of((0,p.Xy)({availableStyles:r.availableStyles}),(0,p.tV)(t.id,"layer",K(K({},r),{},{capabilitiesLoading:null})),(0,j.Wm)()):a().Observable.of((0,j.Fe)("availableStyles",{status:401}),(0,j.Wm)())})).catch((function(t){var e=-1!==t.message.indexOf("could not be unmarshalled")?"parsingCapabilities":"global";return a().Observable.of((0,j.Fe)(e,t),(0,j.Wm)())})).startWith((0,j.pt)("global"))}function nt(t){return r.e(2568).then(r.t.bind(r,402568,23)).then((function(e){return(0,e.default)(t)}))}const at={toggleStyleEditorEpic:function(t,e){return t.ofType(j.vZ).filter((function(){return!(0,L.aN)(e.getState())})).switchMap((function(t){var r=e.getState(),n=(0,B.jN)(r),o=!!l()(n,"options.availableStyles");if(!t.enabled)return function(t){var e=(0,L.gc)(t),r=(0,L.Z0)(t).baseUrl,n=void 0===r?"":r;return a().Observable.of((0,j.l1)(),(0,v.fU)({owner:D.s1})).merge(e?tt({styleName:e,baseUrl:n}):a().Observable.empty())}(r);if((0,L.ji)(r)&&o)return a().Observable.empty();var s=t.layer||(0,B.Iz)(r);if(!s||s&&!s.url)return a().Observable.empty();var i=(0,O.Nd)(s);if(!i)return rt(s);var u=s.url.split(i),c="".concat(u[0]).concat(i),y=(0,L.Z0)(r);return a().Observable.concat(a().Observable.of((0,j.pt)("global"),(0,j.l1)()),a().Observable.defer((function(){return(0,X.eb)({baseUrl:c,styleService:y})})).switchMap((function(t){return a().Observable.concat(a().Observable.of((0,j.E0)(t)),a().Observable.defer((function(){return x(c+"rest/",s.name)})).switchMap((function(t){var e,r=(null==t||null===(e=t.styles)||void 0===e?void 0:e.style)||[],n=m()([t.defaultStyle].concat(J(r)),"name");return 0===n.length?a().Observable.of((0,j.Fe)("availableStyles",{status:401}),(0,j.Wm)()):a().Observable.defer((function(){return Promise.all([N.ZP.getStylesInfo({baseUrl:c,styles:n}),(0,S.kB)(s).toPromise().then((function(t){return t})).catch((function(){return null}))])})).switchMap((function(t){var e=H(t,2),r=e[0],n=e[1],o=n&&(0,w.Br)(n),l=((null==o?void 0:o.availableStyles)||[]).map((function(t){return K(K({},t),(0,D.$N)(t.name))})).filter((function(){return(arguments.length>0&&void 0!==arguments[0]?arguments[0]:{}).name})),i=l.length>0?r.map((function(t){var e=(0,D.$N)(t.name),r=l.find((function(t){return t.name===e.name}))||{},n=(r.name,r.workspace,function(t,e){if(null==t)return{};var r,n,a=function(t,e){if(null==t)return{};var r,n,a={},o=Object.keys(t);for(n=0;n<o.length;n++)r=o[n],e.indexOf(r)>=0||(a[r]=t[r]);return a}(t,e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(t);for(n=0;n<o.length;n++)r=o[n],e.indexOf(r)>=0||Object.prototype.propertyIsEnumerable.call(t,r)&&(a[r]=t[r])}return a}(r,z));return n?K(K({},n),t):t})):r;return a().Observable.of((0,v.W)(s.id,D.s1,"override",{}),(0,p.Xy)({availableStyles:i}),(0,p.tV)(s.id,"layer",{availableStyles:i}),(0,j.Wm)())}))})).catch((function(){return rt(s,!0)})))})))}))},updateLayerOnStatusChangeEpic:function(t,e){return t.ofType(j.g$).filter((function(t){return!!t.status})).switchMap((function(r){var n=e.getState(),o=(0,L.Vf)(n),l=o&&o.params||{},s=o&&!o.describeFeatureType&&(0,g.H)(o.url,o,{query:l}),i=(0,L.i7)(n)||o.availableStyles&&o.availableStyles[0]&&o.availableStyles[0].name,u=(0,L.Z0)(n).baseUrl,c=void 0===u?"":u;return s&&function(t,e){var r,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:function(){return!0},o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:[],l=arguments.length>4&&void 0!==arguments[4]?arguments[4]:function(){};return(r=a().Observable).of.apply(r,[(0,j.pt)("global")].concat(J(o))).merge(t.ofType(p.K$).filter((function(){var t=(0,B.Iz)(e.getState());return n(t)})).switchMap((function(){var t=(0,B.Iz)(e.getState());return l(t)})).catch((function(t){return a().Observable.of((0,j.Fe)("global",t),(0,j.Wm)())})).takeUntil(t.ofType(j.E2)))}(t,e,(function(t){return t&&t.describeLayer}),[s],(function(t){return a().Observable.concat(Y({status:r.status,styleName:i,baseUrl:c}),a().Observable.of((0,j.xR)(!(t&&t.describeLayer&&401===t.describeLayer.error)),(0,j.Wm)()))}))||Y({status:r.status,styleName:i,baseUrl:c})}))},updateTemporaryStyleEpic:function(t,e){return t.ofType(j.TB,j.DX).switchMap((function(t){var r=e.getState(),n=(0,L.gc)(r),a=(0,L.Vf)(r),o=(0,D.$N)(a.name).workspace,l=t.format&&t.format!==(0,L.iB)(r),s=n||"".concat(o?"".concat(o,":"):"").concat((0,D.Vi)()),i=t.format||(0,L.iB)(r),u=(0,L.ex)(r),c=(0,L.Z0)(r).baseUrl,y=void 0===c?"":c,f=(0,L.j5)(r),b="sld"===i&&(t.code||"").match(/version=\"1\.1\.0\"/)&&{version:"1.1.0"}||t.format&&!t.languageVersion&&{version:"1.0.0"}||t.languageVersion||{version:"1.0.0"},m=f.version!==b.version?{params:{raw:!0}}:{},p=b,g=function(e){return et({update:!0,code:t.code,format:i,styleName:e,status:u,baseUrl:y,languageVersion:p,options:m},[(0,v.B1)(D.s1,[{style:e,_v_:Date.now(),singleTile:!0}]),(0,j.k5)({temporaryId:e,templateId:t.templateId||"",code:t.code,format:i,init:t.init,languageVersion:p})],"edit"===u?[]:[(0,d.vU)({title:"styleeditor.updateTmpErrorTitle",message:"styleeditor.updateTmpStyleErrorMessage",uid:"updateTmpStyleError",autoDismiss:5})])},S=("css"===i?"* { stroke: #888888; }":"sld"===i&&'<?xml version="1.0" encoding="ISO-8859-1"?>\n<StyledLayerDescriptor version="1.0.0"\n\t\txsi:schemaLocation="http://www.opengis.net/sld StyledLayerDescriptor.xsd"\n\t\txmlns="http://www.opengis.net/sld"\n\t\txmlns:ogc="http://www.opengis.net/ogc"\n\t\txmlns:xlink="http://www.w3.org/1999/xlink"\n\t\txmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">\n\n\t<NamedLayer>\n\t\t<Name>Default Style</Name>\n\t\t<UserStyle>\n\t\t\t<Title>${styleTitle}</Title>\n\t\t\t<Abstract>${styleAbstract}</Abstract>\n\t\t\t<FeatureTypeStyle>\n\t\t\t\t<Rule>\n\t\t\t\t\t<Name>Rule Name</Name>\n\t\t\t\t\t<Title>Rule Title</Title>\n\t\t\t\t\t<Abstract>Rule Abstract</Abstract>\n\t\t\t\t\t<LineSymbolizer>\n\t\t\t\t\t\t<Stroke>\n\t\t\t\t\t\t\t<CssParameter name="stroke">#0000FF</CssParameter>\n\t\t\t\t\t\t</Stroke>\n\t\t\t\t\t\t</LineSymbolizer>\n\t\t\t\t\t<PointSymbolizer>\n\t\t\t\t\t\t<Graphic>\n\t\t\t\t\t\t\t<Mark>\n\t\t\t\t\t\t\t\t<WellKnownName>square</WellKnownName>\n\t\t\t\t\t\t\t\t<Fill>\n\t\t\t\t\t\t\t\t\t<CssParameter name="fill">#FF0000</CssParameter>\n\t\t\t\t\t\t\t\t</Fill>\n\t\t\t\t\t\t\t</Mark>\n\t\t\t\t\t\t</Graphic>\n\t\t\t\t\t</PointSymbolizer>\n\t\t\t\t\t</Rule>\n\t\t\t\t</FeatureTypeStyle>\n\t\t\t</UserStyle>\n\t\t</NamedLayer>\n\t</StyledLayerDescriptor>\n')||"",h=function(t){return et({code:S,format:i,styleName:t,status:u,baseUrl:y},g(t),[(0,d.vU)({title:"styleeditor.createTmpErrorTitle",message:"styleeditor.createTmpStyleErrorMessage",uid:"createTmpStyleError",autoDismiss:5}),(0,j.k5)({temporaryId:null,templateId:"",code:"",format:"",init:"",languageVersion:null})])};return l&&n&&tt({styleName:n,baseUrl:y,onSuccess$:h("".concat(o?"".concat(o,":"):"").concat((0,D.Vi)())),onError$:g(s)})||n&&g(s)||h(s)}))},createStyleEpic:function(t,e){return t.ofType(j.vA).switchMap((function(t){var r=e.getState(),n=(0,L.gB)(r),o=(0,L.Vf)(r),l=(0,D.$N)(o.name).workspace,s="".concat(l?"".concat(l,":"):"").concat((0,D.nK)(t.settings)),u=(0,L.iB)(r),c=t.settings||{},y=c.title,b=void 0===y?"":y,m=c._abstract,g=void 0===m?"":m,S=(0,L.Z0)(r).baseUrl,h=void 0===S?"":S,O=K({title:b,description:g},{msStyleJSON:null,msEditorType:"visual"}),w=f()(n)({styleTitle:b,styleAbstract:g});return a().Observable.defer((function(){return nt(w).then((function(t){return N.ZP.createStyle({baseUrl:h,code:w,format:u,styleName:s,metadata:K(K({},O),{},{msMD5Hash:t})})}))})).switchMap((function(){return a().Observable.of((0,v.B1)(D.s1,[{}]),(0,p.Xy)({style:s||""},!0),(0,j.Nf)(""),(0,j.Wm)()).merge(function(t){var e=t.baseUrl,r=t.layer,n=t.styleName,o=t.format,l=t.title,s=t._abstract,u=t.metadata;return a().Observable.defer((function(){return $({baseUrl:e,layerName:r.name,styles:[{name:n}]})})).switchMap((function(){var t=K({filename:"".concat(n,".").concat(o),format:o,name:n,title:l,_abstract:s},u&&{metadata:u}),e=i()(r.availableStyles),c=r.availableStyles&&[e,t].concat(J(r.availableStyles.filter((function(t,e){return e>0}))))||[t];return a().Observable.of((0,p.Xy)({availableStyles:c},!0),(0,j.Wm)())})).catch((function(){return a().Observable.of((0,j.Wm)())})).startWith((0,j.pt)("global"))}({layer:o,styleName:s,format:u,title:b,_abstract:g,baseUrl:h,metadata:O}))})).catch((function(t){return a().Observable.of((0,j.Fe)("",t),(0,j.Wm)(),(0,d.vU)({title:"styleeditor.createStyleErrorTitle",message:"styleeditor.createStyleErrorMessage",uid:"createStyleError",autoDismiss:5}))})).startWith((0,j.pt)(""))}))},updateStyleCodeEpic:function(t,e){return t.ofType(j.ch).switchMap((function(){var t=e.getState(),r=(0,L.iB)(t),n=(0,L.j5)(t),o=(0,L.gB)(t),l=(0,L.i7)(t),s=(0,L.gc)(t),i=(0,L.Vf)(t),u=(0,L.Z0)(t).baseUrl,c=void 0===u?"":u,y=(0,L.WW)(t)||{},f={msStyleJSON:y.styleJSON||null,msEditorType:y.editorType},b=(i.availableStyles||[]).map((function(t){return t.name===l?K(K({},t),{},{metadata:K(K({},t.metadata),f)}):t}));return a().Observable.defer((function(){return nt(o).then((function(t){return N.ZP.updateStyle({baseUrl:c,code:o,format:r,styleName:l,languageVersion:n,options:{params:{raw:!0}},metadata:K(K({},f),{},{msMD5Hash:t})})}))})).switchMap((function(){return a().Observable.of((0,j.Wm)(),(0,p.tV)(i.id,"layer",{_v_:Date.now(),availableStyles:b}),(0,p.Xy)({availableStyles:b}),(0,j.k5)({temporaryId:s,templateId:"",code:o,format:r,init:!0,languageVersion:n}),(0,d.Vp)({title:"styleeditor.savedStyleTitle",message:"styleeditor.savedStyleMessage",uid:"savedStyleTitle",autoDismiss:5}))})).catch((function(t){return a().Observable.of((0,j.Fe)("global",t),(0,j.Wm)(),(0,d.vU)({title:"styleeditor.updateStyleErrorTitle",message:"styleeditor.updateStyleErrorMessage",uid:"updateStyleError",autoDismiss:5}))})).startWith((0,j.pt)("global"))}))},deleteStyleEpic:function(t,e){return t.ofType(j.j1).filter((function(t){return!!t.styleName})).switchMap((function(t){var r=t.styleName,n=e.getState(),o=(0,L.Vf)(n),l=(0,L.Z0)(n).baseUrl,s=void 0===l?"":l,i=(0,C.tL)(n),u=(0,C.Gd)(n);return a().Observable.defer((function(){return F({baseUrl:s,layerName:o.name,styles:[{name:r}]})})).switchMap((function(){var t=o.availableStyles&&o.availableStyles.filter((function(t){return t.name!==r}))||[];return a().Observable.concat(a().Observable.of((0,p.Xy)({style:"",availableStyles:t},!0),(0,j.Wm)(),(0,h.Xg)("layersettings","originalSettings",K(K({},i),{},{style:""})),(0,h.Xg)("layersettings","initialSettings",K(K({},u),{},{style:""}))),tt({styleName:r,baseUrl:s,onSuccess$:a().Observable.of((0,d.Vp)({title:"styleeditor.deletedStyleSuccessTitle",message:"styleeditor.deletedStyleSuccessMessage",uid:"deletedStyleSuccess",autoDismiss:5})),onError$:a().Observable.of((0,d.vU)({title:"styleeditor.deletedStyleErrorTitle",message:"styleeditor.deletedStyleErrorMessage",uid:"deletedStyleError",autoDismiss:5}))}))})).catch((function(){return a().Observable.of((0,j.Wm)())})).startWith((function(){return a().Observable.of((0,j.pt)("global"))}))}))},setDefaultStyleEpic:function(t,e){return t.ofType(j.rb).switchMap((function(){var t=e.getState(),r=(0,L.Z0)(t).baseUrl,n=void 0===r?"":r,o=(0,L.Vf)(t),l=(0,L.i7)(t);return a().Observable.defer((function(){return Z({baseUrl:n,layerName:o.name,styleName:l})})).switchMap((function(){var t=o.availableStyles.filter((function(t){var e=t.name;return l===e})),e=o.availableStyles.filter((function(t){var e=t.name;return l!==e})),r=[].concat(J(t),J(e));return a().Observable.of((0,p.Xy)({availableStyles:r},!0),(0,d.Vp)({title:"styleeditor.setDefaultStyleSuccessTitle",message:"styleeditor.setDefaultStyleSuccessMessage",uid:"setDefaultStyleSuccess",autoDismiss:5}),(0,j.Wm)())})).startWith((0,j.pt)("global")).catch((function(){return a().Observable.of((0,d.vU)({title:"styleeditor.setDefaultStyleErrorTitle",message:"styleeditor.setDefaultStyleErrorMessage",uid:"setDefaultStyleError",autoDismiss:5}),(0,j.Wm)())}))}))}}},532244:(t,e,r)=>{"use strict";r.d(e,{Z:()=>c});var n=r(396909),a=r(747037),o=r.n(a);function l(t){return l="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},l(t)}function s(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),r.push.apply(r,n)}return r}function i(t){for(var e=1;e<arguments.length;e++){var r=null!=arguments[e]?arguments[e]:{};e%2?s(Object(r),!0).forEach((function(e){u(t,e,r[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):s(Object(r)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(r,e))}))}return t}function u(t,e,r){return(e=function(t){var e=function(t,e){if("object"!==l(t)||null===t)return t;var r=t[Symbol.toPrimitive];if(void 0!==r){var n=r.call(t,"string");if("object"!==l(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"===l(e)?e:String(e)}(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}const c=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},e=arguments.length>1?arguments[1]:void 0;switch(e.type){case n.wL:return i(i({},t),{},{service:e.service,canEdit:e.canEdit});case n.Nm:return i(i({},t),{},{canEdit:e.canEdit});case n.gF:return i(i({},t),{},{temporaryId:e.temporaryId,templateId:e.templateId,code:e.code,format:e.format,error:null,languageVersion:e.languageVersion,initialCode:e.init?e.code:t.initialCode});case n.g$:return""===e.status?i(i({},t),{},{status:e.status,code:"",templateId:"",initialCode:"",addStyle:!1,error:{}}):i(i({},t),{},{status:e.status});case n.dJ:return{service:t.service&&i({},t.service)||{},canEdit:t.canEdit,loading:t.loading};case n.uz:return i(i({},t),{},{addStyle:e.add});case n.lX:return i(i({},t),{},{loading:!e.status||e.status});case n.E2:return i(i({},t),{},{loading:!1,enabled:!0});case n.mF:var r,a,l,s=(null==e||null===(r=e.error)||void 0===r?void 0:r.statusText)||(null==e||null===(a=e.error)||void 0===a?void 0:a.message)||"",c=o()(null==e||null===(l=e.error)||void 0===l?void 0:l.messageId)&&{messageId:e.error.messageId},y=s.match(/line\s([\d]+)|column\s([\d]+)|lineNumber:\s([\d]+)|columnNumber:\s([\d]+)/g),f=y&&2===y.length&&y.reduce((function(t,e){var r=e.split(" "),n=r[0].replace(/Number:/g,""),a=parseFloat(r[1]);return n&&!isNaN(a)&&i(i({},t),{},u({},n,a))||i({},t)}),i({message:s},c))||i({message:s},c);return i(i({},t),{},{loading:!1,canEdit:!(e.error&&(401===e.error.status||403===e.error.status||e.error.message&&-1!==e.error.message.indexOf("could not be unmarshalled"))),error:i(i({},t.error),{},u({},e.status||"global",i({status:e.error&&e.error.status||400},f)))});case n.dk:return i(i({},t),{},{metadata:i(i({},t.metadata),e.metadata)});default:return t}}}}]);